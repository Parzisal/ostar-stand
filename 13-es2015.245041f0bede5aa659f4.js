(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{Pj3g:function(t,e,n){"use strict";n.d(e,"a",function(){return d});var i=n("fXoL"),o=n("oaey"),s=n("nYR2"),r=n("1G5W"),c=n("lJxs"),a=n("2Vo4"),l=n("EY2u");class d extends o.a{constructor(){super(),this.isLoading$=new a.a(!0),this.pageIndex$=new i.n,this.params=null}stopLoading(){return this.isLoading$.next(!1),l.a}goToPrevPage(){return this.pageIndex$.emit(),l.a}getItems(t){return this.isLoading$.next(!0),t.pipe(Object(s.a)(()=>this.isLoading$.next(!1)),Object(r.a)(this.destroyed),Object(c.a)(t=>(this.items=t.items,this.totalCount=t.total_count,t)))}}},Rr9H:function(t,e,n){"use strict";n.r(e),n.d(e,"DoctorListModule",function(){return bt});var i=n("PCNd"),o=n("S9na"),s=n("fXoL");let r=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)}}),t})();var c=n("tyNb"),a=n("Pj3g"),l=n("UXun"),d=n("1G5W"),u=n("eIep"),b=n("nYR2"),p=n("2Vo4"),m=n("mCNh"),f=n("+K6+"),h=n("dEAy"),g=n("ILvI"),v=n("o5fV"),z=n("3Pt+"),O=n("vxZU");class C extends O.a{constructor(){super()}edit(t,e){return this.editItemRequest(t,"Doctor updated successfully",Object(g.j)(e))}create(t){return this.createItemRequest(t,"Doctor created successfully",g.i)}getGroupOptions(t){return this.getOptions(t,g.k)}getPracticeOptions(t){return this.getOptions(t,g.C)}}var T=n("pfyX"),y=n("TwVa"),S=n("Yn1n"),A=n("ocnv"),w=n("HZS1"),U=n("B+r4"),I=n("bb81"),$=n("5vDB"),L=n("PTRe"),P=n("VdD3"),_=n("ofXK");function x(t,e){if(1&t){const t=s.Vb();s.Ub(0,"nz-form-item"),s.Ub(1,"nz-form-label",6),s.Hc(2,"Practice"),s.Tb(),s.Ub(3,"nz-form-control",3),s.Ub(4,"app-select",19),s.bc("valueChangedEvt",function(e){return s.vc(t),s.ec().practiceValueChanged(e)}),s.Tb(),s.Tb(),s.Tb()}if(2&t){const t=s.ec(),e=s.uc(43);s.Ab(1),s.mc("nzSpan",5),s.Ab(2),s.mc("nzErrorTip",e),s.Ab(1),s.mc("control",t.f.practice)("url",t.practiceUrl)}}function k(t,e){1&t&&(s.Sb(0),s.Hc(1," This field is required "),s.Rb())}function j(t,e){if(1&t&&(s.Sb(0),s.Hc(1),s.Rb()),2&t){const t=s.ec().$implicit;s.Ab(1),s.Jc(" ",t.errors.validationError," ")}}function E(t,e){if(1&t&&(s.Fc(0,k,2,0,"ng-container",20),s.Fc(1,j,2,1,"ng-container",20)),2&t){const t=e.$implicit;s.mc("ngIf",t.hasError("required")),s.Ab(1),s.mc("ngIf",t.hasError("validationError"))}}const M=function(){return["admin"]};let F=(()=>{class t extends T.a{constructor(t,e,n){super(t),this.crudService=e,this.currentUserService=n,this.practiceUrl=g.C,this.groupsUrl=g.k,this.form=new z.h({npi:new z.e("",[z.s.required]),practice:new z.e("",[z.s.required]),first_name:new z.e("",[z.s.required]),last_name:new z.e("",[z.s.required]),middle_name:new z.e(""),email:new z.e("",[z.s.required,z.s.email]),phone:new z.e(""),specialization:new z.e(""),groups:new z.e(null)})}onSaveClick(t){var e;const n=null===(e=this.doctor)||void 0===e?void 0:e.id,i=this.form.value;i.groups=i.groups?[...i.groups]:[];const o=n?this.crudService.edit(i,n):this.crudService.create(i);this.saveItem(t,o)}practiceValueChanged(t){this.loadOptions$.next([{key:"practice",value:t.name}])}ngOnInit(){const t=this.currentUserService.currentUser;if(t.role===S.a.manager&&(this.form.removeControl("practice"),this.loadOptions$.next([{key:"practice",value:t.practice.name}])),this.doctor){for(const t in this.doctor)if(this.doctor[t]&&Object.prototype.hasOwnProperty.call(this.f,t)){if("groups"===t){this.doctor[t]=this.doctor[t].map(t=>Object.assign(new y.e,t)),this.doctor[t].length&&this.f[t].patchValue(this.doctor[t][0].id,{emitEvent:!1});continue}if("object"==typeof this.doctor[t]&&this.f[t]){this.f[t].patchValue(this.doctor[t].id,{emitEvent:!1});continue}this.f[t].patchValue(this.doctor[t],{emitEvent:!1})}this.loadOptions$.next([{key:"practice",value:this.doctor.practice.name}])}this.formInitValue=this.form.getRawValue()}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(h.c),s.Ob(C),s.Ob(f.a))},t.\u0275cmp=s.Ib({type:t,selectors:[["ng-component"]],features:[s.zb([C]),s.xb],decls:44,vars:26,consts:[["nz-form","",1,"form",3,"formGroup"],[4,"appRolesAccess"],[3,"nzSpan"],[3,"nzErrorTip"],["placeholder","Search and select group",3,"control","url","disabled","loadOptions$","canLoad"],[1,"form__item","form__item--multiple-fields"],["nzRequired","",3,"nzSpan"],[1,"form__row"],[1,"form__column"],["nz-input","","formControlName","first_name","autocomplete","","placeholder","First name *"],["nzExtra","optional",3,"nzErrorTip"],["nz-input","","formControlName","middle_name","autocomplete","","placeholder","Middle name"],["nz-input","","formControlName","last_name","autocomplete","","placeholder","Last name *"],["nz-input","","formControlName","npi","autocomplete",""],["nz-input","","formControlName","email","type","email"],["nz-input","","formControlName","specialization","autocomplete",""],["nz-input","","formControlName","phone"],[3,"processing","processingClose","isEditing","formValid","saveEvent","closeEvent"],["errorTpl",""],["placeholder","Search and select practice",3,"control","url","valueChangedEvt"],[4,"ngIf"]],template:function(t,e){if(1&t&&(s.Ub(0,"form",0),s.Fc(1,x,5,4,"nz-form-item",1),s.Ub(2,"nz-form-item"),s.Ub(3,"nz-form-label",2),s.Hc(4,"Group"),s.Tb(),s.Ub(5,"nz-form-control",3),s.Pb(6,"app-select",4),s.Tb(),s.Tb(),s.Pb(7,"nz-divider"),s.Ub(8,"nz-form-item",5),s.Ub(9,"nz-form-label",6),s.Hc(10,"Name"),s.Tb(),s.Ub(11,"div",7),s.Ub(12,"nz-form-item",8),s.Ub(13,"nz-form-control",3),s.Pb(14,"input",9),s.Tb(),s.Tb(),s.Ub(15,"nz-form-item",8),s.Ub(16,"nz-form-control",10),s.Pb(17,"input",11),s.Tb(),s.Tb(),s.Ub(18,"nz-form-item",8),s.Ub(19,"nz-form-control",3),s.Pb(20,"input",12),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Ub(21,"nz-form-item"),s.Ub(22,"nz-form-label",6),s.Hc(23,"NPI"),s.Tb(),s.Ub(24,"nz-form-control",3),s.Pb(25,"input",13),s.Tb(),s.Tb(),s.Ub(26,"nz-form-item"),s.Ub(27,"nz-form-label",6),s.Hc(28,"Email"),s.Tb(),s.Ub(29,"nz-form-control",3),s.Pb(30,"input",14),s.Tb(),s.Tb(),s.Ub(31,"nz-form-item"),s.Ub(32,"nz-form-label",2),s.Hc(33,"Specialization"),s.Tb(),s.Ub(34,"nz-form-control",3),s.Pb(35,"input",15),s.Tb(),s.Tb(),s.Ub(36,"nz-form-item"),s.Ub(37,"nz-form-label",2),s.Hc(38,"Phone"),s.Tb(),s.Ub(39,"nz-form-control",3),s.Pb(40,"input",16),s.Tb(),s.Tb(),s.Tb(),s.Ub(41,"app-modal-footer",17),s.bc("saveEvent",function(t){return e.onSaveClick(t)})("closeEvent",function(){return e.closeModal()}),s.Tb(),s.Fc(42,E,2,2,"ng-template",null,18,s.Gc)),2&t){const t=s.uc(43);s.mc("formGroup",e.form),s.Ab(1),s.mc("appRolesAccess",s.oc(25,M)),s.Ab(2),s.mc("nzSpan",5),s.Ab(2),s.mc("nzErrorTip",t),s.Ab(1),s.mc("control",e.f.groups)("url",e.groupsUrl)("disabled",!(null!=e.f.practice&&e.f.practice.valid))("loadOptions$",e.loadOptions$.asObservable())("canLoad",!1),s.Ab(3),s.mc("nzSpan",5),s.Ab(4),s.mc("nzErrorTip",t),s.Ab(3),s.mc("nzErrorTip",t),s.Ab(3),s.mc("nzErrorTip",t),s.Ab(3),s.mc("nzSpan",5),s.Ab(2),s.mc("nzErrorTip",t),s.Ab(3),s.mc("nzSpan",5),s.Ab(2),s.mc("nzErrorTip",t),s.Ab(3),s.mc("nzSpan",5),s.Ab(2),s.mc("nzErrorTip",t),s.Ab(3),s.mc("nzSpan",5),s.Ab(2),s.mc("nzErrorTip",t),s.Ab(2),s.mc("processing",e.processing)("processingClose",e.processingClose)("isEditing",!(null==e.doctor||!e.doctor.id))("formValid",e.form.valid)}},directives:[z.t,z.o,A.b,z.i,w.a,U.c,A.c,U.a,A.d,A.a,I.a,$.a,L.b,z.d,z.n,z.g,P.a,_.o],encapsulation:2}),t})(),D=(()=>{class t extends v.a{constructor(){super()}getDoctorList(t){return this.getItems(t,g.i)}addDoctor(){return this.openModal("Add new doctor",void 0,F)}editDoctor(t){return this.openModal(`Edit doctor ${t.first_name} ${t.last_name}`,{doctor:t},F)}deleteDoctor(t){return this.deleteItem(`Are you sure you want to delete doctor ${t.first_name} ${t.last_name}?`,Object(g.j)(t.id))}resendActivationEmail(t){return this.http.post(Object(g.E)(t),{})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:r}),t})(),V=(()=>{class t extends D{constructor(){super(),this.displayColumns=[{name:"NPI",filterKey:"npi",customFilter:"search",sort:!0,filter:!0,visible:!1},{name:"Name",filterKey:"name",customFilter:"search",sort:!0,filter:!0,visible:!1},{name:"Specialization"},{name:"Practice",filterKey:"practice",customFilter:"search",filter:!0,visible:!1},{name:"Group"},{name:"Email",filterKey:"email",customFilter:"search",filter:!0,visible:!1},{name:"Phone"},{name:"State",filterMultiple:!1,filterKey:"active",listOfFilter:[{text:"Active",value:"true"},{text:"Inactive",value:"false"}],filter:!0,visible:!1,pipe:"state"},{name:""}]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:r}),t})(),H=(()=>{class t extends D{constructor(){super(),this.displayColumns=[{name:"NPI",filterKey:"npi",customFilter:"search",sort:!0,filter:!0,visible:!1},{name:"Name",filterKey:"name",customFilter:"search",sort:!0,filter:!0,visible:!1},{name:"Specialization"},{name:"Group"},{name:"Email",filterKey:"email",customFilter:"search",filter:!0,visible:!1},{name:"Phone"},{name:"State",filterMultiple:!1,filterKey:"active",listOfFilter:[{text:"Active",value:"true"},{text:"Inactive",value:"false"}],filter:!0,visible:!1,pipe:"state"},{name:""}]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:r}),t})();const N=new s.q("DoctorListService"),R={provide:N,useFactory:t=>{switch(t.currentRole){case"admin":return new V;case"manager":return new H}},deps:[f.a,h.d]};var K=n("bNXi"),G=n("jPNr"),q=n("OzZK"),X=n("RwU8"),Y=n("C2AL"),Z=n("1ReC"),B=n("rMZv"),J=n("Nqz0"),W=n("FwiY"),Q=n("Q8cG"),tt=n("ZyQt");const et=function(){return["/import-data/doctors"]};function nt(t,e){1&t&&(s.Ub(0,"button",6),s.Hc(1,"Import doctors"),s.Tb()),2&t&&s.mc("routerLink",s.oc(1,et))}function it(t,e){if(1&t&&(s.Ub(0,"td"),s.Hc(1),s.Tb()),2&t){const t=s.ec().$implicit;s.Ab(1),s.Ic(null==t.practice?null:t.practice.name)}}function ot(t,e){1&t&&(s.Ub(0,"nz-tag",22),s.Hc(1,"active"),s.Tb())}function st(t,e){1&t&&(s.Ub(0,"nz-tag",23),s.Hc(1,"inactive"),s.Tb())}const rt=function(t){return{"ant-btn-link--disabled":t}};function ct(t,e){if(1&t){const t=s.Vb();s.Ub(0,"button",24),s.bc("click",function(){s.vc(t);const e=s.ec().$implicit;return s.ec().onResendActivationEmailClick(e)}),s.fc(1,"async"),s.fc(2,"async"),s.Ub(3,"div",25),s.fc(4,"async"),s.Pb(5,"i",26),s.fc(6,"async"),s.Ub(7,"span"),s.Hc(8,"Resend activation email"),s.Tb(),s.Tb(),s.Tb()}if(2&t){const t=s.ec(2);s.mc("nzDisabled",s.gc(1,4,t.emailIsSendingAsObs$))("disabled",s.gc(2,6,t.emailIsSendingAsObs$)),s.Ab(3),s.mc("ngClass",s.pc(12,rt,s.gc(4,8,t.emailIsSendingAsObs$))),s.Ab(2),s.mc("nzType",s.gc(6,10,t.emailIsSendingAsObs$)?"loading":"mail")}}const at=function(){return["admin"]};function lt(t,e){if(1&t){const t=s.Vb();s.Ub(0,"tr"),s.Ub(1,"td"),s.Hc(2),s.Tb(),s.Ub(3,"td"),s.Hc(4),s.Tb(),s.Ub(5,"td"),s.Hc(6),s.Tb(),s.Fc(7,it,2,1,"td",7),s.Ub(8,"td"),s.Hc(9),s.Tb(),s.Ub(10,"td"),s.Hc(11),s.Tb(),s.Ub(12,"td"),s.Hc(13),s.Tb(),s.Ub(14,"td",8),s.Fc(15,ot,2,0,"nz-tag",9),s.Fc(16,st,2,0,"nz-tag",10),s.Tb(),s.Ub(17,"td",11),s.Ub(18,"div"),s.Ub(19,"button",12),s.Pb(20,"i",13),s.Tb(),s.Ub(21,"nz-dropdown-menu",null,14),s.Ub(23,"div",15),s.Fc(24,ct,9,14,"button",16),s.Ub(25,"button",17),s.bc("click",function(){s.vc(t);const n=e.$implicit;return s.ec().onEditClick(n)}),s.Ub(26,"div",18),s.Pb(27,"i",19),s.Ub(28,"span"),s.Hc(29,"Edit"),s.Tb(),s.Tb(),s.Tb(),s.Ub(30,"button",17),s.bc("click",function(){s.vc(t);const n=e.$implicit;return s.ec().onDeleteClick(n)}),s.Ub(31,"div",20),s.Pb(32,"i",21),s.Ub(33,"span"),s.Hc(34,"Delete"),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb(),s.Tb()}if(2&t){const t=e.$implicit,n=s.uc(22);s.Ab(2),s.Ic(t.npi),s.Ab(2),s.Lc("",t.first_name," ",t.middle_name," ",t.last_name,""),s.Ab(2),s.Ic(t.specialization),s.Ab(1),s.mc("appRolesAccess",s.oc(13,at)),s.Ab(2),s.Ic(null==t.groups[0]?null:t.groups[0].name),s.Ab(2),s.Ic(t.email),s.Ab(2),s.Ic(t.phone),s.Ab(2),s.mc("ngIf",t.active),s.Ab(1),s.mc("ngIf",!t.active),s.Ab(3),s.mc("nzDropdownMenu",n),s.Ab(5),s.mc("ngIf",!t.active)}}const dt=[{path:"",component:(()=>{class t extends a.a{constructor(t,e){super(),this.doctorListService=t,this.notifService=e,this.emailIsSending$=new p.a(!1),this.displayColumns=this.doctorListService.displayColumns}get emailIsSendingAsObs$(){return this.emailIsSending$.pipe(Object(l.a)(1))}getDoctors(t=this.params){return this.getItems(this.doctorListService.getDoctorList(t)).pipe(Object(d.a)(this.destroyed))}get doctorsPipe(){return Object(m.a)(Object(u.a)(()=>this.getDoctors()))}onAddClick(){this.doctorListService.addDoctor().pipe(this.doctorsPipe).subscribe()}onEditClick(t){this.doctorListService.editDoctor(t).pipe(this.doctorsPipe).subscribe()}onResendActivationEmailClick(t){this.emailIsSending$.next(!0),this.doctorListService.resendActivationEmail(t.id).pipe(Object(d.a)(this.destroyed),Object(b.a)(()=>this.emailIsSending$.next(!1))).subscribe(()=>this.notifService.success("Email has been sent to "+t.email,""))}onDeleteClick(t){this.doctorListService.deleteDoctor(t).pipe(Object(u.a)(()=>1===this.items.length?this.goToPrevPage():this.getDoctors())).subscribe()}onQueryParamsChange(t){this.params=t,this.getDoctors().subscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(N),s.Ob(K.b))},t.\u0275cmp=s.Ib({type:t,selectors:[["ng-component"]],features:[s.zb([R]),s.xb],decls:8,vars:8,consts:[[1,"panel"],["nzTitle","Doctor list",1,"page-header"],["nz-button","","nzType","link",3,"routerLink",4,"appRolesAccess"],["nz-button","","nzType","primary",3,"click"],[3,"data","totalCount","isLoading$","pageIndex$","displayColumns","queryParamsChange"],[4,"ngFor","ngForOf"],["nz-button","","nzType","link",3,"routerLink"],[4,"appRolesAccess"],[1,"table-cell__state"],["nzColor","green",4,"ngIf"],["nzColor","red",4,"ngIf"],[1,"table-cell__actions"],["nz-button","","nzType","link","nzTrigger","click","nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","icon:more","nzTheme","outline"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","","class","btn--menu-item",3,"nzDisabled","disabled","click",4,"ngIf"],["nz-menu-item","",1,"btn--menu-item",3,"click"],[1,"ant-btn-sm","ant-btn-link","ant-btn"],["nz-icon","","nzType","edit","nzTheme","outline"],[1,"ant-btn-sm","ant-btn-link","ant-btn","ant-btn-dangerous"],["nz-icon","","nzType","delete","nzTheme","outline"],["nzColor","green"],["nzColor","red"],["nz-menu-item","",1,"btn--menu-item",3,"nzDisabled","disabled","click"],[1,"ant-btn-sm","ant-btn-link","ant-btn",3,"ngClass"],["nz-icon","","nzTheme","outline",3,"nzType"]],template:function(t,e){1&t&&(s.Ub(0,"div",0),s.Ub(1,"nz-page-header",1),s.Ub(2,"nz-page-header-extra"),s.Fc(3,nt,2,2,"button",2),s.Ub(4,"button",3),s.bc("click",function(){return e.onAddClick()}),s.Hc(5,"Add doctor"),s.Tb(),s.Tb(),s.Tb(),s.Ub(6,"app-table-wrapper",4),s.bc("queryParamsChange",function(t){return e.onQueryParamsChange(t)}),s.Fc(7,lt,35,14,"tr",5),s.Tb(),s.Tb()),2&t&&(s.Ab(3),s.mc("appRolesAccess",s.oc(7,at)),s.Ab(3),s.mc("data",e.items)("totalCount",e.totalCount)("isLoading$",e.isLoading$.asObservable())("pageIndex$",e.pageIndex$)("displayColumns",e.displayColumns),s.Ab(1),s.mc("ngForOf",e.items))},directives:[G.a,G.c,w.a,q.a,X.a,Y.a,Z.a,_.n,c.f,B.i,B.b,_.o,J.d,J.b,W.a,J.e,Q.c,Q.d,tt.a,_.m],pipes:[_.b],styles:[".ant-btn-link--disabled[_ngcontent-%COMP%]{color:rgba(0,0,0,.25);background:transparent;border-color:transparent;text-shadow:none;box-shadow:none;cursor:not-allowed}"]}),t})()}];let ut=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[c.h.forChild(dt)],c.h]}),t})(),bt=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[i.a,ut,r,o.a]]}),t})()},TwVa:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"g",function(){return o}),n.d(e,"b",function(){return s}),n.d(e,"f",function(){return c}),n.d(e,"c",function(){return a}),n.d(e,"e",function(){return l}),n.d(e,"d",function(){return d}),n.d(e,"h",function(){return u});class i{constructor(){}get label(){return this.device_id}}class o{constructor(){}get label(){return`${this.first_name} ${this.middle_name||""} ${this.last_name} - ${this.patient_id}`}}class s extends class{}{get label(){return`${this.first_name} ${this.last_name} - ${this.npi}`}}var r=n("2Vo4");class c{constructor(t,e=null){this.totalCount=0,this.items$=new r.a(new Array),this.searchChange$=new r.a(null),this.getRequestFuncName=t,this.type=e}}class a{constructor(){}}class l{get label(){return this.name}}class d{constructor(t){Object.assign(this,t)}}class u{get label(){return this.name}}},VdD3:function(t,e,n){"use strict";n.d(e,"a",function(){return b});var i=n("fXoL"),o=n("dEAy"),s=n("OzZK"),r=n("RwU8"),c=n("C2AL"),a=n("ofXK");function l(t,e){if(1&t){const t=i.Vb();i.Ub(0,"button",5),i.bc("click",function(){return i.vc(t),i.ec(2).onSaveClick(!1)}),i.Hc(1,"Save & Add another"),i.Tb()}if(2&t){const t=i.ec(2);i.mc("disabled",!t.formValid)("nzLoading",t.processing&&!t.processingClose)}}function d(t,e){1&t&&(i.Ub(0,"span"),i.Hc(1,"\xa0& Close"),i.Tb())}function u(t,e){if(1&t){const t=i.Vb();i.Sb(0),i.Ub(1,"button",1),i.bc("click",function(){return i.vc(t),i.ec().closeModal()}),i.Hc(2,"Cancel"),i.Tb(),i.Fc(3,l,2,2,"button",2),i.Ub(4,"button",3),i.bc("click",function(){return i.vc(t),i.ec().onSaveClick(!0)}),i.Hc(5,"Save"),i.Fc(6,d,2,0,"span",4),i.Tb(),i.Rb()}if(2&t){const t=i.ec();i.Ab(3),i.mc("ngIf",!t.isEditing),i.Ab(1),i.mc("disabled",!t.formValid)("nzLoading",t.processing&&t.processingClose),i.Ab(2),i.mc("ngIf",!t.isEditing)}}let b=(()=>{class t{constructor(){this.saveEvent=new i.n,this.closeEvent=new i.n,this.formValid=!0}closeModal(){this.closeEvent.emit()}onSaveClick(t){this.saveEvent.emit(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Ib({type:t,selectors:[["app-modal-footer"]],inputs:{processing:"processing",processingClose:"processingClose",formValid:"formValid",isEditing:"isEditing"},outputs:{saveEvent:"saveEvent",closeEvent:"closeEvent"},decls:1,vars:0,consts:[[4,"nzModalFooter"],["nz-button","",3,"click"],["nz-button","","nzType","default",3,"disabled","nzLoading","click",4,"ngIf"],["nz-button","","nzType","primary",3,"disabled","nzLoading","click"],[4,"ngIf"],["nz-button","","nzType","default",3,"disabled","nzLoading","click"]],template:function(t,e){1&t&&i.Fc(0,u,7,4,"ng-container",0)},directives:[o.a,s.a,r.a,c.a,a.o],encapsulation:2}),t})()},bb81:function(t,e,n){"use strict";n.d(e,"a",function(){return j});var i=n("fXoL"),o=n("EY2u"),s=n("HDdC"),r=n("2Vo4"),c=n("1G5W"),a=n("vkgz"),l=n("/uUt"),d=n("Kj3r"),u=n("eIep"),b=n("nYR2"),p=n("JIr8"),m=n("pLZG"),f=n("oaey"),h=n("CvgI"),g=n("UXun"),v=n("lJxs"),z=n("ovFC"),O=n("tk/3");let C=(()=>{class t{constructor(t){this.http=t,this.options$=new r.a([]),this.totalCount$=new r.a(0),this.isLoadingMore$=new r.a(!1),this.isLoading$=new r.a(!0),this.filters={}}get optionsAsObservable$(){return this.options$.asObservable()}get options(){return this.options$.value}set options(t){this.options$.next([...t])}get totalCount(){return this.totalCount$.value}set totalCount(t){this.totalCount$.next(t)}get isLoadingMore(){return this.isLoadingMore$.value}set isLoadingMore(t){this.isLoadingMore$.next(t)}get isLoadingMoreAsObservable$(){return this.isLoadingMore$.pipe(Object(g.a)(1))}get isLoadingAsObservable$(){return this.isLoading$.pipe(Object(g.a)(1))}get isLoading(){return this.isLoading$.value}set isLoading(t){this.isLoading$.next(t)}loadMoreOptions(t,e){return this.options.length<this.totalCount?(this.isLoadingMore=!0,this.getOptionsRequest(t).pipe(Object(v.a)(t=>{this.totalCount=t.total_count;const n=e?t.items.map(t=>e(t)):t.items;this.options=[...this.options,...n]}),Object(b.a)(()=>this.isLoadingMore=!1))):o.a}getOptions(t,e){return this.getOptionsRequest(t).pipe(Object(v.a)(t=>{this.totalCount=t.total_count,this.options=e?t.items.map(t=>e(t)):t.items}),Object(b.a)(()=>this.isLoading=!1))}getOptionsRequest(t){const e=Object(h.a)(Object.assign({limit:15,offset:this.options.length},this.filters));return this.http.get(t,{params:e})}}return t.\u0275fac=function(e){return new(e||t)(i.Yb(O.c))},t.\u0275prov=i.Kb({token:t,factory:t.\u0275fac,providedIn:z.a}),t})();var T=n("zAKX"),y=n("3Pt+"),S=n("vxfF"),A=n("ofXK"),w=n("qAZ0"),U=n("QlLE");function I(t,e){if(1&t&&i.Pb(0,"nz-option",7),2&t){const t=e.$implicit,n=i.ec();i.mc("nzValue",t.id)("nzLabel",t[n.labelKey])("nzDisabled",n.optionDisabled(t.id))}}function $(t,e){1&t&&(i.Ub(0,"nz-option",8),i.Ub(1,"div",9),i.Pb(2,"nz-spin"),i.Ub(3,"span",10),i.Hc(4,"Searching..."),i.Tb(),i.Tb(),i.Tb())}function L(t,e){1&t&&(i.Ub(0,"div",14),i.Pb(1,"nz-spin"),i.Ub(2,"span"),i.Hc(3,"Loading data..."),i.Tb(),i.Tb())}function P(t,e){if(1&t&&(i.Ub(0,"div",12),i.Fc(1,L,4,0,"div",13),i.fc(2,"async"),i.Tb()),2&t){const t=i.ec(2),e=i.uc(10);i.Ab(1),i.mc("ngIf",i.gc(2,2,t.isLoadingMore$))("ngIfElse",e)}}function _(t,e){if(1&t&&i.Fc(0,P,3,4,"div",11),2&t){const t=i.ec();i.mc("ngIf",!t.isSearching&&t.totalCount>15&&"tags"!==t.mode)}}function x(t,e){if(1&t&&(i.Ub(0,"div",15),i.Hc(1),i.Tb()),2&t){const t=i.ec();i.Ab(1),i.Kc("",t.options.length," of ",t.totalCount,"")}}function k(t,e){if(1&t&&i.Pb(0,"nz-empty",16),2&t){const t=i.ec();i.mc("nzNotFoundContent",t.noDataText)}}let j=(()=>{class t extends f.a{constructor(t){super(),this.selectService=t,this.labelKey="name",this.size="default",this.mode="default",this.filterName="name",this.canLoad=!0,this.loadOptions$=new s.a,this.valueChangedEvt=new i.n,this.searchChange$=new r.a(null)}get totalCount(){return this.selectService.totalCount}get options(){return this.selectService.options}onScrollToBottom(){this.selectService.loadMoreOptions(this.url,this.transformFunc).pipe(Object(c.a)(this.destroyed)).subscribe()}onSearch(t){(t||this.selectService.filters[this.filterName])&&(this.isSearching=!0,this.searchChange$.next(t))}onOpenChange(t){!t&&this.selectService.filters[this.filterName]&&(this.selectService.filters[this.filterName]=null,this.selectService.options=[],this.getOptions())}selectionValueChanged(t){t&&this.valueChangedEvt.emit(this.selectService.options.find(e=>e.id===t))}searchOptions(){return this.searchChange$.asObservable().pipe(Object(a.a)(t=>{this.selectService.options=[],this.selectService.filters[this.filterName]=t}),Object(l.a)(),Object(d.a)(500),Object(u.a)(()=>this.selectService.getOptions(this.url,this.transformFunc).pipe(Object(b.a)(()=>{this.isSearching=!1,this.disabled=!1}),Object(p.a)(()=>o.a))),Object(c.a)(this.destroyed))}getOptions(){this.selectService.getOptions(this.url,this.transformFunc).pipe(Object(c.a)(this.destroyed)).subscribe()}optionDisabled(t){return!(!this.disabledOptions||!this.disabledOptions.length)&&this.disabledOptions.map(t=>t.id).includes(t)}ngOnInit(){const t=this.control.value;t&&(this.selectService.filters.include=t),this.isLoading$=this.selectService.isLoadingAsObservable$,this.isLoadingMore$=this.selectService.isLoadingMoreAsObservable$,this.options$=this.selectService.optionsAsObservable$,this.canLoad&&this.searchOptions().subscribe(),this.loadOptions$.pipe(Object(a.a)(()=>{this.disabled=!0,this.selectService.isLoading=!0}),Object(c.a)(this.destroyed),Object(m.a)(t=>!!t),Object(u.a)(t=>(t.forEach(t=>this.selectService.filters[t.key]=t.value),this.canLoad=!0,this.searchOptions()))).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(C))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-select"]],inputs:{control:"control",url:"url",labelKey:"labelKey",size:"size",disabled:"disabled",placeholder:"placeholder",mode:"mode",maxTagCount:"maxTagCount",filterName:"filterName",canLoad:"canLoad",disabledOptions:"disabledOptions",noDataText:"noDataText",transformFunc:"transformFunc",loadOptions$:"loadOptions$"},outputs:{valueChangedEvt:"valueChangedEvt"},features:[i.zb([C]),i.xb],decls:13,vars:20,consts:[["nzAllowClear","","nzServerSearch","","nzShowSearch","",3,"nzSize","nzPlaceHolder","formControl","nzLoading","nzDisabled","nzMode","nzMaxTagCount","nzDropdownRender","nzShowArrow","nzNotFoundContent","nzOnSearch","nzOpenChange","ngModelChange","nzScrollToBottom"],[3,"itemSize","maxBufferPx"],[3,"nzValue","nzLabel","nzDisabled",4,"ngFor","ngForOf"],["nzDisabled","","nzCustomContent","",4,"ngIf"],["loadingMoreOptionsTpl",""],["totalCountTpl",""],["noDataTpl",""],[3,"nzValue","nzLabel","nzDisabled"],["nzDisabled","","nzCustomContent",""],[1,"searching-option"],[1,"searching-option__text"],["class","dropdown-footer",4,"ngIf"],[1,"dropdown-footer"],["class","dropdown-footer__spinner",4,"ngIf","ngIfElse"],[1,"dropdown-footer__spinner"],[1,"dropdown-footer__total"],["nzNotFoundImage","simple",3,"nzNotFoundContent"]],template:function(t,e){if(1&t&&(i.Ub(0,"nz-select",0),i.bc("nzOnSearch",function(t){return e.onSearch(t)})("nzOpenChange",function(t){return e.onOpenChange(t)})("ngModelChange",function(t){return e.selectionValueChanged(t)})("nzScrollToBottom",function(){return e.onScrollToBottom()}),i.fc(1,"async"),i.fc(2,"async"),i.Ub(3,"cdk-virtual-scroll-viewport",1),i.Fc(4,I,1,3,"nz-option",2),i.fc(5,"async"),i.Tb(),i.Fc(6,$,5,0,"nz-option",3),i.Fc(7,_,1,1,"ng-template",null,4,i.Gc),i.Tb(),i.Fc(9,x,2,2,"ng-template",null,5,i.Gc),i.Fc(11,k,1,1,"ng-template",null,6,i.Gc)),2&t){const t=i.uc(8),n=i.uc(12);i.mc("nzSize",e.size)("nzPlaceHolder",e.placeholder)("formControl",e.control)("nzLoading",e.canLoad&&i.gc(1,14,e.isLoading$))("nzDisabled",e.disabled||i.gc(2,16,e.isLoading$))("nzMode",e.mode)("nzMaxTagCount",e.maxTagCount)("nzDropdownRender",t)("nzShowArrow",!0)("nzNotFoundContent",n),i.Ab(3),i.mc("itemSize",32)("maxBufferPx",160),i.Ab(1),i.mc("ngForOf",i.gc(5,18,e.options$)),i.Ab(2),i.mc("ngIf",e.isSearching)}},directives:[T.d,y.n,y.f,S.b,S.a,A.n,A.o,T.a,w.a,U.b],pipes:[A.b],styles:["[_nghost-%COMP%], [_nghost-%COMP%]   nz-select[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]     .ant-select-arrow{top:48%}.dropdown-footer[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;align-items:center;justify-items:start;padding:4px 14px;color:#1890ff;border-top:1px solid #f0f0f0}.dropdown-footer__total[_ngcontent-%COMP%]{width:100%;grid-column:2/3;display:flex;justify-content:flex-end}.dropdown-footer__spinner[_ngcontent-%COMP%]{display:flex;align-items:center}.dropdown-footer__spinner[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:18px}.dropdown-footer[_ngcontent-%COMP%]   nz-spin[_ngcontent-%COMP%]{margin-left:12px}.option[_ngcontent-%COMP%]{display:flex}.option[_ngcontent-%COMP%]   nz-spin[_ngcontent-%COMP%]{margin-left:.9em}.option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#1890ff;margin-left:1.1em}.searching-option[_ngcontent-%COMP%]{display:flex;align-items:center}.searching-option[_ngcontent-%COMP%]   nz-spin[_ngcontent-%COMP%]{margin-left:.8em}.searching-option__text[_ngcontent-%COMP%]{margin-left:1.2em}"],changeDetection:0}),t})()},o5fV:function(t,e,n){"use strict";n.d(e,"a",function(){return b});var i=n("mrSG"),o=n("sbGu"),s=n("dEAy"),r=n("CvgI"),c=n("tk/3"),a=n("lJxs"),l=n("pLZG"),d=n("fXoL");let u=(()=>{class t{constructor(t){this.modal=t,this.modal.updateConfig({nzWrapClassName:"vertical-center-modal",nzMaskClosable:!0,nzAutofocus:null,nzOkType:"danger",nzOkText:"Delete",nzClosable:!1})}}return t.\u0275fac=function(e){return new(e||t)(d.Ob(s.c))},t.\u0275cmp=d.Ib({type:t,selectors:[["ng-component"]],decls:0,vars:0,template:function(t,e){},encapsulation:2,changeDetection:0}),t})();class b{constructor(){const t=o.a.getInjector;this.http=t.get(c.c),this.modalService=t.get(s.d)}getItems(t,e,n){const i=Object(r.a)(t),o=Object.assign({params:i},n);return this.http.get(e,Object.assign({},o)).pipe(Object(a.a)(t=>t))}openModal(t,e=null,n,i=!0,o=600){return this.modalService.create(Object.assign(Object.assign({},i&&{nzWrapClassName:"vertical-center-modal"}),{nzTitle:t,nzWidth:o+"px",nzContent:n,nzComponentParams:Object.assign({},e)})).afterClose.pipe(Object(l.a)(t=>t))}openActionConfirmationModal(t,e){return this.modalService.confirm({nzContent:e,nzTitle:t,nzOnOk:()=>!0}).afterClose.pipe(Object(l.a)(t=>t))}deleteItem(t,e){return this.modalService.confirm({nzContent:u,nzTitle:t,nzOnOk:t=>Object(i.a)(this,void 0,void 0,function*(){return t.modal.config.nzOkLoading=!0,yield this.deleteItemRequest(e)})}).afterClose.pipe(Object(l.a)(t=>t))}deleteItemRequest(t){return Object(i.a)(this,void 0,void 0,function*(){return yield this.http.delete(t).toPromise().then(t=>"success"===t.status)})}}},pfyX:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var i=n("oaey"),o=n("sbGu"),s=n("lhsU"),r=n("3Pt+"),c=n("1G5W"),a=n("nYR2"),l=n("2Vo4"),d=n("bNXi");class u extends i.a{constructor(t){super(),this.modal=t,this.loadOptions$=new l.a(null),this.updateAfterClosing=!1;const e=o.a.getInjector;this.errorService=e.get(s.a),this.notifService=e.get(d.b)}get f(){return this.form.controls}set formInitValue(t){this.formInitialValue=Object.assign({},t)}closeModal(t=this.updateAfterClosing){this.modal.destroy(t)}saveItem(t,e,n=null){this.processing=!0,this.processingClose=t,this.form&&(this.markFormGroupTouched(this.form),this.errorService.form=this.form),e.pipe(Object(c.a)(this.destroyed),Object(a.a)(()=>this.processing=!1)).subscribe(()=>{n&&this.notifService.success(n,""),t?this.closeModal(!0):(this.form&&this.form.reset(this.formInitialValue),this.updateAfterClosing=!0)})}onItemSelected(t,e,n){n.push(t),e.patchValue(null,{emitEvent:!1})}onDeleteItemClick(t,e){this[e]=this[e].filter(e=>e.id!==t)}markFormGroupTouched(t){Object.values(t.controls).forEach(t=>{t.markAsTouched(),t instanceof r.h&&this.markFormGroupTouched(t)})}}}}]);