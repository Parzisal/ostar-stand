!function(){function e(r,t){return(e=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(r,t)}function r(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,i=n(e);if(r){var c=n(this).constructor;o=Reflect.construct(i,arguments,c)}else o=i.apply(this,arguments);return t(this,o)}}function t(e,r){return!r||"object"!=typeof r&&"function"!=typeof r?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):r}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,r,t){return r&&o(e.prototype,r),t&&o(e,t),e}function c(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{MJku:function(t,n,o){"use strict";o.r(n),o.d(n,"ShipstationModule",function(){return q});var a,s,f=o("PCNd"),u=o("tyNb"),b=o("3Pt+"),l=o("oaey"),p=o("LRne"),d=o("EY2u"),m=o("vkgz"),h=o("5+tZ"),v=o("lJxs"),y=o("JIr8"),z=o("1G5W"),O=o("pLZG"),T=o("UXun"),g=o("fXoL"),S=o("LEIr"),w=o("ILvI"),C=((a=function e(){c(this,e)}).\u0275mod=g.Mb({type:a}),a.\u0275inj=g.Lb({factory:function(e){return new(e||a)}}),a),U=o("tk/3"),j=((s=function(){function e(r){c(this,e),this.http=r}return i(e,[{key:"editOrder",value:function(e,r){return this.http.put(Object(w.u)(e),Object.assign({},r))}},{key:"createOrder",value:function(e){var r=(new Date).toISOString();return this.http.post(w.c,{device_order_id:e}).pipe(Object(v.a)(function(e){return Object.assign(Object.assign({},e),{ship_date:r})}))}},{key:"compareAddresses",value:function(e,r){var t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(var o=0,i=t;o<i.length;o++){var c=i[o];if(e[c]!==r[c])return!1}return!0}}]),e}()).\u0275fac=function(e){return new(e||s)(g.Yb(U.c))},s.\u0275prov=g.Kb({token:s,factory:s.\u0275fac,providedIn:C}),s),P=o("lhsU"),_=o("5vDB"),A=o("ocnv"),E=o("B+r4"),k=o("PTRe"),D=o("ofXK");function I(e,r){1&e&&(g.Sb(0),g.Hc(1," This field is required "),g.Rb())}function x(e,r){if(1&e&&(g.Sb(0),g.Hc(1),g.Rb()),2&e){var t=g.ec().$implicit;g.Ab(1),g.Jc(" ",t.errors.validationError," ")}}function N(e,r){if(1&e&&(g.Fc(0,I,2,0,"ng-container",15),g.Fc(1,x,2,1,"ng-container",15)),2&e){var t=r.$implicit;g.mc("ngIf",t.hasError("required")),g.Ab(1),g.mc("ngIf",t.hasError("validationError"))}}var M,H,L,R=[{path:"",component:(M=function(t){!function(r,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),t&&e(r,t)}(o,t);var n=r(o);function o(e,r,t){var i;return c(this,o),(i=n.call(this)).orderDetailsService=e,i.shipstationService=r,i.errorService=t,i.cartonDimensionsLables=["Length","Width","Height"],i.formAddress=new b.h({company:new b.e(""),name:new b.e("",[b.s.required]),phone:new b.e(""),country:new b.e("",[b.s.required]),city:new b.e("",[b.s.required]),state:new b.e("",[b.s.required]),postal_code:new b.e("",[b.s.required]),street1:new b.e("",[b.s.required]),street2:new b.e(""),street3:new b.e("")}),i}return i(o,[{key:"saveOrderAddressChanges",value:function(){if(this.shipstationService.compareAddresses(this.formAddress.value,this.orderDetailsService.orderInfo.address))return Object(p.a)(!0);for(var e in this.f)Object.prototype.hasOwnProperty.call(this.f,e)&&this.f[e].markAsTouched();return this.errorService.flattenError=!0,this.errorService.form=this.formAddress,this.shipstationService.editOrder(this.orderDetailsService.orderInfo.id,{address:this.formAddress.value})}},{key:"handleError",value:function(e){return e&&this.orderDetailsService.errors$.next("object"==typeof e?Object.values(e):e),this.orderDetailsService.onConfirmation$.next(!1),d.a}},{key:"handleConfirmEvt",value:function(){var e=this;this.orderDetailsService.confirmEvt.pipe(Object(m.a)(function(){e.errorService.showNotif=!1,e.orderDetailsService.onConfirmation$.next(!0),e.orderDetailsService.errors$.next(null)}),Object(h.b)(function(){return e.saveOrderAddressChanges().pipe(Object(v.a)(function(){return e.orderDetailsService.orderInfo.address=e.formAddress.value}),Object(y.a)(function(){return e.handleError()}))}),Object(h.b)(function(){return e.shipstationService.createOrder(e.orderDetailsService.orderInfo.id).pipe(Object(y.a)(function(r){return e.handleError(r.error.errors)}))}),Object(z.a)(this.destroyed)).subscribe(function(r){e.orderDetailsService.onConfirmation$.next(!1),e.errorService.showNotif=!0,r&&(e.orderDetailsService.orderInfo.ship_station_order_id=r.id,e.orderDetailsService.orderInfo.tracking_number=r.tracking_number,e.orderDetailsService.orderInfo.ship_date=r.ship_date,e.orderDetailsService.goToNextStep())})}},{key:"ngOnInit",value:function(){var e=this;this.handleConfirmEvt(),this.orderDetailsService.orderInfo$.pipe(Object(O.a)(function(e){return!!e}),Object(z.a)(this.destroyed)).subscribe(function(r){return e.formAddress.patchValue(r.address)}),this.formAddress.valueChanges.pipe(Object(z.a)(this.destroyed)).subscribe(function(){return e.orderDetailsService.addressFormIsValid=e.formAddress.valid}),this.onConfirmation$=this.orderDetailsService.onConfirmation$.pipe(Object(T.a)(1))}},{key:"f",get:function(){return this.formAddress.controls}}]),o}(l.a),M.\u0275fac=function(e){return new(e||M)(g.Ob(S.a),g.Ob(j),g.Ob(P.a))},M.\u0275cmp=g.Ib({type:M,selectors:[["app-shipstation"]],features:[g.xb],decls:57,vars:11,consts:[["nzText","Edit postal information","nzOrientation","left",1,"large"],["nz-form","","nzLayout","vertical",1,"form",3,"formGroup"],["nzRequired",""],[3,"nzErrorTip"],["formControlName","name","nz-input",""],["formControlName","phone","nz-input",""],["formControlName","company","nz-input",""],["formControlName","country","nz-input",""],["formControlName","state","nz-input",""],["formControlName","city","nz-input",""],["formControlName","postal_code","nz-input",""],["formControlName","street1","nz-input",""],["formControlName","street2","nz-input",""],["formControlName","street3","nz-input",""],["errorTpl",""],[4,"ngIf"]],template:function(e,r){if(1&e&&(g.Pb(0,"nz-divider",0),g.Ub(1,"form",1),g.Ub(2,"section"),g.Ub(3,"nz-form-item"),g.Ub(4,"nz-form-label",2),g.Hc(5,"Name of receiver"),g.Tb(),g.Ub(6,"nz-form-control",3),g.Pb(7,"input",4),g.Tb(),g.Tb(),g.Ub(8,"nz-form-item"),g.Ub(9,"nz-form-label"),g.Hc(10,"Phone of receiver"),g.Tb(),g.Ub(11,"nz-form-control",3),g.Pb(12,"input",5),g.Tb(),g.Tb(),g.Ub(13,"nz-form-item"),g.Ub(14,"nz-form-label"),g.Hc(15,"Company"),g.Tb(),g.Ub(16,"nz-form-control",3),g.Pb(17,"input",6),g.Tb(),g.Tb(),g.Tb(),g.Ub(18,"section"),g.Ub(19,"nz-form-item"),g.Ub(20,"nz-form-label",2),g.Hc(21,"Country"),g.Tb(),g.Ub(22,"nz-form-control",3),g.Pb(23,"input",7),g.Tb(),g.Tb(),g.Ub(24,"nz-form-item"),g.Ub(25,"nz-form-label",2),g.Hc(26,"State"),g.Tb(),g.Ub(27,"nz-form-control",3),g.Pb(28,"input",8),g.Tb(),g.Tb(),g.Ub(29,"nz-form-item"),g.Ub(30,"nz-form-label",2),g.Hc(31,"City"),g.Tb(),g.Ub(32,"nz-form-control",3),g.Pb(33,"input",9),g.Tb(),g.Tb(),g.Ub(34,"nz-form-item"),g.Ub(35,"nz-form-label",2),g.Hc(36,"Postal code"),g.Tb(),g.Ub(37,"nz-form-control",3),g.Pb(38,"input",10),g.Tb(),g.Tb(),g.Tb(),g.Ub(39,"section"),g.Ub(40,"nz-form-item"),g.Ub(41,"nz-form-label",2),g.Hc(42,"Street 1"),g.Tb(),g.Ub(43,"nz-form-control",3),g.Pb(44,"input",11),g.Tb(),g.Tb(),g.Ub(45,"nz-form-item"),g.Ub(46,"nz-form-label"),g.Hc(47,"Street 2"),g.Tb(),g.Ub(48,"nz-form-control",3),g.Pb(49,"input",12),g.Tb(),g.Tb(),g.Ub(50,"nz-form-item"),g.Ub(51,"nz-form-label"),g.Hc(52,"Street 3"),g.Tb(),g.Ub(53,"nz-form-control",3),g.Pb(54,"input",13),g.Tb(),g.Tb(),g.Tb(),g.Tb(),g.Fc(55,N,2,2,"ng-template",null,14,g.Gc)),2&e){var t=g.uc(56);g.Ab(1),g.mc("formGroup",r.formAddress),g.Ab(5),g.mc("nzErrorTip",t),g.Ab(5),g.mc("nzErrorTip",t),g.Ab(5),g.mc("nzErrorTip",t),g.Ab(6),g.mc("nzErrorTip",t),g.Ab(5),g.mc("nzErrorTip",t),g.Ab(5),g.mc("nzErrorTip",t),g.Ab(5),g.mc("nzErrorTip",t),g.Ab(6),g.mc("nzErrorTip",t),g.Ab(5),g.mc("nzErrorTip",t),g.Ab(5),g.mc("nzErrorTip",t)}},directives:[_.a,b.t,b.o,A.b,b.i,E.c,A.c,E.a,A.d,A.a,b.d,k.b,b.n,b.g,D.o],styles:[".actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.form[_ngcontent-%COMP%]{max-width:900px}.form[_ngcontent-%COMP%] > section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:2em;align-items:center}.form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button, .form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.form[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]}),M)}],$=((L=function e(){c(this,e)}).\u0275mod=g.Mb({type:L}),L.\u0275inj=g.Lb({factory:function(e){return new(e||L)},imports:[[u.h.forChild(R)],u.h]}),L),q=((H=function e(){c(this,e)}).\u0275mod=g.Mb({type:H}),H.\u0275inj=g.Lb({factory:function(e){return new(e||H)},imports:[[f.a,$,C]]}),H)}}])}();