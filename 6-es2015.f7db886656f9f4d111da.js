(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{Crpy:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var o=n("PCNd"),i=n("FZeK"),r=n("tyNb"),s=n("fXoL");let c=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[o.a,i.a,r.h]]}),t})()},FZeK:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var o=n("fXoL");let i=(()=>{class t{}return t.\u0275mod=o.Mb({type:t}),t.\u0275inj=o.Lb({factory:function(e){return new(e||t)}}),t})()},KebF:function(t,e,n){"use strict";n.d(e,"a",function(){return N});var o=n("Pj3g"),i=n("mCNh"),r=n("1G5W"),s=n("eIep"),c=n("fXoL"),a=n("ILvI"),l=n("o5fV"),d=n("3Pt+"),u=n("pfyX"),b=n("vxZU"),p=n("FZeK");let m=(()=>{class t extends b.a{constructor(){super()}edit(t,e){return this.editItemRequest(e,"Record updated successfully",Object(a.z)(t))}create(t,e){return this.createItemRequest(e,"Record created successfully",Object(a.z)(t))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:p.a}),t})();var f=n("dEAy"),h=n("ocnv"),g=n("B+r4"),v=n("0lU3"),z=n("PTRe"),y=n("VdD3"),T=n("ofXK");function C(t,e){1&t&&(c.Sb(0),c.Hc(1," This field is required "),c.Rb())}function I(t,e){if(1&t&&(c.Sb(0),c.Hc(1),c.Rb()),2&t){const t=c.ec().$implicit;c.Ab(1),c.Jc(" ",t.errors.validationError," ")}}function w(t,e){if(1&t&&(c.Fc(0,C,2,0,"ng-container",11),c.Fc(1,I,2,1,"ng-container",11)),2&t){const t=e.$implicit;c.mc("ngIf",t.hasError("required")),c.Ab(1),c.mc("ngIf",t.hasError("validationError"))}}const O=function(){return{nzFormat:"hh:mm a"}};let k=(()=>{class t extends u.a{constructor(t,e){super(t),this.crudPatientLogRecordsService=e,this.form=new d.h({duration:new d.e(null,[d.s.required]),note:new d.e("",[d.s.required]),creation_date:new d.e(null,[d.s.required])})}onSaveClick(t){var e;const n=null===(e=this.record)||void 0===e?void 0:e.id,o=this.form.value,i=n?this.crudPatientLogRecordsService.edit(this.patientId,Object.assign(Object.assign({},o),{record_id:n})):this.crudPatientLogRecordsService.create(this.patientId,o);this.saveItem(t,i)}ngOnInit(){if(this.record)for(const t in this.record)if(this.record[t]&&Object.prototype.hasOwnProperty.call(this.f,t)){if("creation_date"===t){this.f[t].patchValue(new Date(this.record[t]),{emitEvent:!1});continue}this.f[t].patchValue(this.record[t],{emitEvent:!1})}this.formInitValue=this.form.getRawValue()}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(f.c),c.Ob(m))},t.\u0275cmp=c.Ib({type:t,selectors:[["ng-component"]],features:[c.zb([m]),c.xb],decls:19,vars:13,consts:[["nz-form","",1,"form",3,"formGroup"],[1,"form__item"],["nzRequired","",3,"nzSpan"],[3,"nzErrorTip"],["nzFormat","dd/MM/yyyy hh:mm a","formControlName","creation_date",3,"nzShowTime"],["nzExtra","in minutes",3,"nzErrorTip"],["nz-input","","formControlName","duration","autocomplete","","type","number"],[1,"form__item","form__item--textarea"],["formControlName","note","nz-input","","rows","3"],[3,"processing","processingClose","isEditing","formValid","saveEvent","closeEvent"],["errorTpl",""],[4,"ngIf"]],template:function(t,e){if(1&t&&(c.Ub(0,"form",0),c.Ub(1,"nz-form-item",1),c.Ub(2,"nz-form-label",2),c.Hc(3,"Date"),c.Tb(),c.Ub(4,"nz-form-control",3),c.Pb(5,"nz-date-picker",4),c.Tb(),c.Tb(),c.Ub(6,"nz-form-item",1),c.Ub(7,"nz-form-label",2),c.Hc(8,"Duration"),c.Tb(),c.Ub(9,"nz-form-control",5),c.Pb(10,"input",6),c.Tb(),c.Tb(),c.Ub(11,"nz-form-item",7),c.Ub(12,"nz-form-label",2),c.Hc(13,"Note"),c.Tb(),c.Ub(14,"nz-form-control",3),c.Pb(15,"textarea",8),c.Tb(),c.Tb(),c.Tb(),c.Ub(16,"app-modal-footer",9),c.bc("saveEvent",function(t){return e.onSaveClick(t)})("closeEvent",function(){return e.closeModal()}),c.Tb(),c.Fc(17,w,2,2,"ng-template",null,10,c.Gc)),2&t){const t=c.uc(18);c.mc("formGroup",e.form),c.Ab(2),c.mc("nzSpan",4),c.Ab(2),c.mc("nzErrorTip",t),c.Ab(1),c.mc("nzShowTime",c.oc(12,O)),c.Ab(2),c.mc("nzSpan",4),c.Ab(2),c.mc("nzErrorTip",t),c.Ab(3),c.mc("nzSpan",4),c.Ab(2),c.mc("nzErrorTip",t),c.Ab(2),c.mc("processing",e.processing)("processingClose",e.processingClose)("isEditing",!(null==e.record||!e.record.id))("formValid",e.form.valid)}},directives:[d.t,d.o,h.b,d.i,g.c,h.c,g.a,h.d,h.a,v.b,d.n,d.g,z.b,d.d,d.q,y.a,T.o],encapsulation:2}),t})(),P=(()=>{class t extends l.a{constructor(){super()}getPatientLog(t,e){return this.getItems(e,Object(a.z)(t))}addRecord(t){return this.openModal("Add new note",{patientId:t},k)}editRecord(t,e){return this.openModal("Edit note",{patientId:t,record:e},k)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:p.a}),t})();var L=n("eFim"),A=n("5vDB"),R=n("HZS1"),E=n("1ReC"),S=n("OzZK"),U=n("RwU8"),j=n("C2AL"),_=n("tyNb"),F=n("rMZv"),V=n("FwiY");function x(t,e){if(1&t){const t=c.Vb();c.Ub(0,"button",7),c.bc("click",function(){return c.vc(t),c.ec().addNewRecord()}),c.Hc(1,"Add note"),c.Tb()}}function M(t,e){1&t&&(c.Ub(0,"a",8),c.Hc(1,"All notes"),c.Tb())}function H(t,e){if(1&t){const t=c.Vb();c.Ub(0,"tr"),c.Ub(1,"td",9),c.Hc(2),c.fc(3,"date"),c.Tb(),c.Ub(4,"td",9),c.Hc(5),c.Tb(),c.Ub(6,"td"),c.Hc(7),c.Tb(),c.Ub(8,"td",10),c.Ub(9,"button",11),c.bc("click",function(){c.vc(t);const n=e.$implicit;return c.ec().onEditClick(n)}),c.Ub(10,"div",12),c.Pb(11,"i",13),c.Ub(12,"span"),c.Hc(13,"Edit"),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&t){const t=e.$implicit;c.Ab(2),c.Ic(c.hc(3,3,t.creation_date,"short")),c.Ab(3),c.Ic(t.duration),c.Ab(2),c.Ic(t.note)}}const D=function(){return["doctor"]};let N=(()=>{class t extends o.a{constructor(t,e){super(),this.patientLogRecordsService=t,this.timeTrackerService=e,this.allowQueryParams=!0,this.showAllBtn=!0,this.showPagination=!0,this.patientLogRecordsDisplayedColumns=[{name:"Date"},{name:"Duration"},{name:"Note"},{name:""}]}getPatientLogRecords(t=this.params){return this.limit&&(this.params.limit=this.limit),this.getItems(this.patientLogRecordsService.getPatientLog(this.patientId,t)).pipe(Object(r.a)(this.destroyed))}onQueryParamsChange(t){this.params=t,this.getPatientLogRecords().subscribe()}get patientLogRecordsPipe(){return Object(i.a)(Object(s.a)(()=>this.getPatientLogRecords()))}onEditClick(t){this.patientLogRecordsService.editRecord(this.patientId,t).pipe(this.patientLogRecordsPipe).subscribe()}addNewRecord(){this.patientLogRecordsService.addRecord(this.patientId).pipe(this.patientLogRecordsPipe).subscribe()}ngOnInit(){this.timeTrackerService.newDataTracking$.pipe(this.patientLogRecordsPipe,Object(r.a)(this.destroyed)).subscribe()}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(P),c.Ob(L.a))},t.\u0275cmp=c.Ib({type:t,selectors:[["app-patient-log-records"]],inputs:{limit:"limit",allowQueryParams:"allowQueryParams",showAllBtn:"showAllBtn",showPagination:"showPagination",patientId:"patientId"},features:[c.xb],decls:7,vars:11,consts:[["nzText","Patient log","nzOrientation","left",1,"large"],[1,"patient-log-records"],[1,"patient-log-records__actions"],["nz-button","","nzType","primary","class","patient-log-records__btn",3,"click",4,"appRolesAccess"],["nz-button","","nzType","link","class","patient-log-records__btn","routerLink","./patient-log-records","skipLocationChange","",4,"ngIf"],[3,"data","totalCount","isLoading$","pageIndex$","allowQueryParams","nzShowPagination","displayColumns","queryParamsChange"],[4,"ngFor","ngForOf"],["nz-button","","nzType","primary",1,"patient-log-records__btn",3,"click"],["nz-button","","nzType","link","routerLink","./patient-log-records","skipLocationChange","",1,"patient-log-records__btn"],[1,"table-cell__small"],[1,"table-cell__actions"],[1,"btn--menu-item",3,"click"],[1,"ant-btn-sm","ant-btn-link","ant-btn"],["nz-icon","","nzType","edit","nzTheme","outline"]],template:function(t,e){1&t&&(c.Pb(0,"nz-divider",0),c.Ub(1,"div",1),c.Ub(2,"div",2),c.Fc(3,x,2,0,"button",3),c.Fc(4,M,2,0,"a",4),c.Tb(),c.Ub(5,"app-table-wrapper",5),c.bc("queryParamsChange",function(t){return e.onQueryParamsChange(t)}),c.Fc(6,H,14,6,"tr",6),c.Tb(),c.Tb()),2&t&&(c.Ab(3),c.mc("appRolesAccess",c.oc(10,D)),c.Ab(1),c.mc("ngIf",e.showAllBtn),c.Ab(1),c.mc("data",e.items)("totalCount",e.totalCount)("isLoading$",e.isLoading$.asObservable())("pageIndex$",e.pageIndex$)("allowQueryParams",e.allowQueryParams)("nzShowPagination",e.showPagination)("displayColumns",e.patientLogRecordsDisplayedColumns),c.Ab(1),c.mc("ngForOf",e.items))},directives:[A.a,R.a,T.o,E.a,T.n,S.a,U.a,j.a,_.g,F.i,F.b,V.a],pipes:[T.e],styles:[".patient-log-records__actions[_ngcontent-%COMP%]{display:flex;margin-bottom:1em}.patient-log-records__btn[_ngcontent-%COMP%]{margin-right:.5em}"]}),t})()},VdD3:function(t,e,n){"use strict";n.d(e,"a",function(){return b});var o=n("fXoL"),i=n("dEAy"),r=n("OzZK"),s=n("RwU8"),c=n("C2AL"),a=n("ofXK");function l(t,e){if(1&t){const t=o.Vb();o.Ub(0,"button",5),o.bc("click",function(){return o.vc(t),o.ec(2).onSaveClick(!1)}),o.Hc(1,"Save & Add another"),o.Tb()}if(2&t){const t=o.ec(2);o.mc("disabled",!t.formValid)("nzLoading",t.processing&&!t.processingClose)}}function d(t,e){1&t&&(o.Ub(0,"span"),o.Hc(1,"\xa0& Close"),o.Tb())}function u(t,e){if(1&t){const t=o.Vb();o.Sb(0),o.Ub(1,"button",1),o.bc("click",function(){return o.vc(t),o.ec().closeModal()}),o.Hc(2,"Cancel"),o.Tb(),o.Fc(3,l,2,2,"button",2),o.Ub(4,"button",3),o.bc("click",function(){return o.vc(t),o.ec().onSaveClick(!0)}),o.Hc(5,"Save"),o.Fc(6,d,2,0,"span",4),o.Tb(),o.Rb()}if(2&t){const t=o.ec();o.Ab(3),o.mc("ngIf",!t.isEditing),o.Ab(1),o.mc("disabled",!t.formValid)("nzLoading",t.processing&&t.processingClose),o.Ab(2),o.mc("ngIf",!t.isEditing)}}let b=(()=>{class t{constructor(){this.saveEvent=new o.n,this.closeEvent=new o.n,this.formValid=!0}closeModal(){this.closeEvent.emit()}onSaveClick(t){this.saveEvent.emit(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Ib({type:t,selectors:[["app-modal-footer"]],inputs:{processing:"processing",processingClose:"processingClose",formValid:"formValid",isEditing:"isEditing"},outputs:{saveEvent:"saveEvent",closeEvent:"closeEvent"},decls:1,vars:0,consts:[[4,"nzModalFooter"],["nz-button","",3,"click"],["nz-button","","nzType","default",3,"disabled","nzLoading","click",4,"ngIf"],["nz-button","","nzType","primary",3,"disabled","nzLoading","click"],[4,"ngIf"],["nz-button","","nzType","default",3,"disabled","nzLoading","click"]],template:function(t,e){1&t&&o.Fc(0,u,7,4,"ng-container",0)},directives:[i.a,r.a,s.a,c.a,a.o],encapsulation:2}),t})()},o5fV:function(t,e,n){"use strict";n.d(e,"a",function(){return b});var o=n("mrSG"),i=n("sbGu"),r=n("dEAy"),s=n("CvgI"),c=n("tk/3"),a=n("lJxs"),l=n("pLZG"),d=n("fXoL");let u=(()=>{class t{constructor(t){this.modal=t,this.modal.updateConfig({nzWrapClassName:"vertical-center-modal",nzMaskClosable:!0,nzAutofocus:null,nzOkType:"danger",nzOkText:"Delete",nzClosable:!1})}}return t.\u0275fac=function(e){return new(e||t)(d.Ob(r.c))},t.\u0275cmp=d.Ib({type:t,selectors:[["ng-component"]],decls:0,vars:0,template:function(t,e){},encapsulation:2,changeDetection:0}),t})();class b{constructor(){const t=i.a.getInjector;this.http=t.get(c.c),this.modalService=t.get(r.d)}getItems(t,e,n){const o=Object(s.a)(t),i=Object.assign({params:o},n);return this.http.get(e,Object.assign({},i)).pipe(Object(a.a)(t=>t))}openModal(t,e=null,n,o=!0,i=600){return this.modalService.create(Object.assign(Object.assign({},o&&{nzWrapClassName:"vertical-center-modal"}),{nzTitle:t,nzWidth:i+"px",nzContent:n,nzComponentParams:Object.assign({},e)})).afterClose.pipe(Object(l.a)(t=>t))}openActionConfirmationModal(t,e){return this.modalService.confirm({nzContent:e,nzTitle:t,nzOnOk:()=>!0}).afterClose.pipe(Object(l.a)(t=>t))}deleteItem(t,e){return this.modalService.confirm({nzContent:u,nzTitle:t,nzOnOk:t=>Object(o.a)(this,void 0,void 0,function*(){return t.modal.config.nzOkLoading=!0,yield this.deleteItemRequest(e)})}).afterClose.pipe(Object(l.a)(t=>t))}deleteItemRequest(t){return Object(o.a)(this,void 0,void 0,function*(){return yield this.http.delete(t).toPromise().then(t=>"success"===t.status)})}}},pfyX:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var o=n("oaey"),i=n("sbGu"),r=n("lhsU"),s=n("3Pt+"),c=n("1G5W"),a=n("nYR2"),l=n("2Vo4"),d=n("bNXi");class u extends o.a{constructor(t){super(),this.modal=t,this.loadOptions$=new l.a(null),this.updateAfterClosing=!1;const e=i.a.getInjector;this.errorService=e.get(r.a),this.notifService=e.get(d.b)}get f(){return this.form.controls}set formInitValue(t){this.formInitialValue=Object.assign({},t)}closeModal(t=this.updateAfterClosing){this.modal.destroy(t)}saveItem(t,e,n=null){this.processing=!0,this.processingClose=t,this.form&&(this.markFormGroupTouched(this.form),this.errorService.form=this.form),e.pipe(Object(c.a)(this.destroyed),Object(a.a)(()=>this.processing=!1)).subscribe(()=>{n&&this.notifService.success(n,""),t?this.closeModal(!0):(this.form&&this.form.reset(this.formInitialValue),this.updateAfterClosing=!0)})}onItemSelected(t,e,n){n.push(t),e.patchValue(null,{emitEvent:!1})}onDeleteItemClick(t,e){this[e]=this[e].filter(e=>e.id!==t)}markFormGroupTouched(t){Object.values(t.controls).forEach(t=>{t.markAsTouched(),t instanceof s.h&&this.markFormGroupTouched(t)})}}}}]);