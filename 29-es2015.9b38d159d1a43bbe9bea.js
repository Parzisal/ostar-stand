(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{TtQc:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return e.greenHighNormal="rgb(56, 142, 60)",e.greenNormal="rgb(67, 160, 71)",e.greenLowNormal="rgb(76, 175, 80)",e.greenLow="rgb(102, 187, 106)",e.redSevere="rgb(246, 71, 71)",e.redModerate="rgb(226, 106, 106)",e.redMild="rgb(224, 130, 131)",e.yellow="rgb(253, 191, 80)",e}({})},rXnx:function(e,t,n){"use strict";n.r(t),n.d(t,"PatientListModule",function(){return $e});var r=n("PCNd"),i=n("tyNb"),a=n("fXoL");let o=(()=>{class e{}return e.\u0275mod=a.Mb({type:e}),e.\u0275inj=a.Lb({factory:function(t){return new(t||e)}}),e})();var c=n("TwVa"),s=n("ILvI"),l=n("vxZU"),m=n("lJxs");class b extends l.a{constructor(){super()}edit(e,t){return this.editItemRequest(e,"Patient updated successfully",Object(s.B)(t))}create(e){return this.createItemRequest(e,"Patient created successfully",s.y)}getDeviceOptions(e){const t=Object.assign(Object.assign({},e),{active:!0,assigned_to_patient:!1});return this.getOptions(t,s.f)}getDoctorOptions(e){return this.getOptions(e,s.i)}getGroupOptions(e){return this.getOptions(e,s.k)}getPracticeOptions(e){return this.getOptions(e,s.C)}addDevicesRequest(e,t){return this.http.put(Object(s.B)(t),{devices:e}).pipe(Object(m.a)(e=>(this.notifService.success("Devices added successfully",""),e)))}}var p=n("0x4I"),d=n("Yn1n"),u=n("dEAy"),f=n("+K6+"),h=n("3Pt+"),z=n("ocnv"),v=n("HZS1"),g=n("B+r4"),T=n("bb81"),y=n("5vDB"),U=n("PTRe"),C=n("zAKX"),_=n("ofXK"),A=n("0lU3"),O=n("VdD3");function P(e,t){if(1&e){const e=a.Vb();a.Ub(0,"nz-form-item"),a.Ub(1,"nz-form-label",2),a.Hc(2,"Practice"),a.Tb(),a.Ub(3,"nz-form-control",3),a.Ub(4,"app-select",33),a.bc("valueChangedEvt",function(t){return a.vc(e),a.ec().practiceValueChanged(t)}),a.Tb(),a.Tb(),a.Tb()}if(2&e){const e=a.ec(),t=a.uc(99);a.Ab(1),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",t),a.Ab(1),a.mc("control",e.f.practice)("url",e.practiceUrl)}}function D(e,t){if(1&e&&a.Pb(0,"nz-option",34),2&e){const e=t.$implicit;a.mc("nzValue",e.key)("nzLabel",e.value)}}function k(e,t){1&e&&(a.Sb(0),a.Hc(1," This field is required "),a.Rb())}function S(e,t){if(1&e&&(a.Sb(0),a.Hc(1),a.Rb()),2&e){const e=a.ec().$implicit;a.Ab(1),a.Jc(" ",e.errors.validationError," ")}}function E(e,t){if(1&e&&(a.Fc(0,k,2,0,"ng-container",35),a.Fc(1,S,2,1,"ng-container",35)),2&e){const e=t.$implicit;a.mc("ngIf",e.hasError("required")),a.Ab(1),a.mc("ngIf",e.hasError("validationError"))}}const w=function(){return["admin"]};let x=(()=>{class e extends p.a{constructor(e,t,n){super(e),this.crudService=t,this.currentUserService=n,this.practiceUrl=s.C,this.groupsUrl=s.k,this.doctorsUrl=s.i,this.transformToDoctorClass=e=>Object.assign(new c.b,e)}onSaveClick(e){var t;const n=null===(t=this.patient)||void 0===t?void 0:t.id,r=n?this.crudService.edit(this.formValue,n):this.crudService.create(this.formValue);this.saveItem(e,r)}fillForm(e){var t;for(const n in e)if(e[n]&&Object.prototype.hasOwnProperty.call(this.f,n)){if("address"===n){this.f[n].patchValue(e[n]);continue}if("doctor"===n&&(e[n]=Object.assign(new c.b,e[n])),"groups"===n){e[n]=e[n].map(e=>Object.assign(new c.e,e)),e[n].length&&this.f[n].patchValue(e[n][0].id,{emitEvent:!1});continue}if("birth_date"===n){this.f[n].patchValue(new Date(e[n]),{emitEvent:!1});continue}if("object"==typeof e[n]){this.f[n].patchValue(e[n].id,{emitEvent:!1});continue}this.f[n].patchValue(e[n],{emitEvent:!1})}this.patient.practice&&this.loadOptions$.next([{key:"practice",value:null===(t=this.patient.practice)||void 0===t?void 0:t.name}])}ngOnInit(){const e=this.currentUserService.currentUser;e.role===d.a.manager&&(this.form.removeControl("practice"),this.loadOptions$.next([{key:"practice",value:e.practice.name}])),this.patient&&this.fillForm(this.patient)}}return e.\u0275fac=function(t){return new(t||e)(a.Ob(u.c),a.Ob(b),a.Ob(f.a))},e.\u0275cmp=a.Ib({type:e,selectors:[["ng-component"]],features:[a.zb([b]),a.xb],decls:100,vars:57,consts:[["nz-form","",1,"form","form--large",3,"formGroup"],[4,"appRolesAccess"],["nzRequired","",3,"nzSpan"],[3,"nzErrorTip"],["labelKey","label","placeholder","Search and select doctor",3,"control","url","transformFunc","disabled","loadOptions$","canLoad"],[3,"nzSpan"],["placeholder","Search and select group",3,"control","url","disabled","loadOptions$","canLoad"],[1,"form__item","form__item--multiple-fields"],[1,"form__row"],[1,"form__column"],["nz-input","","formControlName","first_name","autocomplete","","placeholder","First name *"],["nzExtra","optional",3,"nzErrorTip"],["nz-input","","formControlName","middle_name","autocomplete","","placeholder","Middle name"],["nz-input","","formControlName","last_name","autocomplete","","placeholder","Last name *"],["nzFor","sex",3,"nzSpan"],["formControlName","sex"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["formControlName","birth_date","nzInputReadOnly","","nzFormat","MM/dd/yyyy",3,"nzShowToday"],["nz-input","","formControlName","patient_id","autocomplete",""],["nz-input","","formControlName","phone","autocomplete",""],["nz-input","","formControlName","email","autocomplete","","type","email"],["formGroupName","address"],["formControlName","street1","nz-input",""],["formControlName","street2","nz-input",""],["formControlName","street3","nz-input",""],["formControlName","city","nz-input",""],["formControlName","state","nz-input",""],["formControlName","postal_code","nz-input",""],["formControlName","company","nz-input",""],[1,"form__item","form__item--textarea"],["formControlName","notes","nz-input","","rows","3"],[3,"processing","processingClose","isEditing","formValid","saveEvent","closeEvent"],["errorTpl",""],["placeholder","Search and select practice",3,"control","url","valueChangedEvt"],[3,"nzValue","nzLabel"],[4,"ngIf"]],template:function(e,t){if(1&e&&(a.Ub(0,"form",0),a.Ub(1,"section"),a.Fc(2,P,5,4,"nz-form-item",1),a.Ub(3,"nz-form-item"),a.Ub(4,"nz-form-label",2),a.Hc(5,"Doctor"),a.Tb(),a.Ub(6,"nz-form-control",3),a.Pb(7,"app-select",4),a.Tb(),a.Tb(),a.Ub(8,"nz-form-item"),a.Ub(9,"nz-form-label",5),a.Hc(10,"Group"),a.Tb(),a.Ub(11,"nz-form-control",3),a.Pb(12,"app-select",6),a.Tb(),a.Tb(),a.Pb(13,"nz-divider"),a.Ub(14,"nz-form-item",7),a.Ub(15,"nz-form-label",2),a.Hc(16,"Name"),a.Tb(),a.Ub(17,"div",8),a.Ub(18,"nz-form-item",9),a.Ub(19,"nz-form-control",3),a.Pb(20,"input",10),a.Tb(),a.Tb(),a.Ub(21,"nz-form-item",9),a.Ub(22,"nz-form-control",11),a.Pb(23,"input",12),a.Tb(),a.Tb(),a.Ub(24,"nz-form-item",9),a.Ub(25,"nz-form-control",3),a.Pb(26,"input",13),a.Tb(),a.Tb(),a.Tb(),a.Tb(),a.Ub(27,"nz-form-item"),a.Ub(28,"nz-form-label",14),a.Hc(29,"Sex"),a.Tb(),a.Ub(30,"nz-form-control",3),a.Ub(31,"nz-select",15),a.Fc(32,D,1,2,"nz-option",16),a.fc(33,"keyvalue"),a.Tb(),a.Tb(),a.Tb(),a.Ub(34,"nz-form-item"),a.Ub(35,"nz-form-label",5),a.Hc(36,"Birthdate"),a.Tb(),a.Ub(37,"nz-form-control",3),a.Pb(38,"nz-date-picker",17),a.Tb(),a.Tb(),a.Ub(39,"nz-form-item"),a.Ub(40,"nz-form-label",2),a.Hc(41,"Patient ID"),a.Tb(),a.Ub(42,"nz-form-control",3),a.Pb(43,"input",18),a.Tb(),a.Tb(),a.Ub(44,"nz-form-item"),a.Ub(45,"nz-form-label",2),a.Hc(46,"Phone"),a.Tb(),a.Ub(47,"nz-form-control",3),a.Pb(48,"input",19),a.Tb(),a.Tb(),a.Ub(49,"nz-form-item"),a.Ub(50,"nz-form-label",5),a.Hc(51,"Email"),a.Tb(),a.Ub(52,"nz-form-control",3),a.Pb(53,"input",20),a.Tb(),a.Tb(),a.Tb(),a.Ub(54,"section"),a.Ub(55,"div",21),a.Ub(56,"nz-form-item"),a.Ub(57,"nz-form-label",2),a.Hc(58,"Street 1"),a.Tb(),a.Ub(59,"nz-form-control",3),a.Pb(60,"input",22),a.Tb(),a.Tb(),a.Ub(61,"nz-form-item"),a.Ub(62,"nz-form-label",5),a.Hc(63,"Street 2"),a.Tb(),a.Ub(64,"nz-form-control",3),a.Pb(65,"input",23),a.Tb(),a.Tb(),a.Ub(66,"nz-form-item"),a.Ub(67,"nz-form-label",5),a.Hc(68,"Street 3"),a.Tb(),a.Ub(69,"nz-form-control",3),a.Pb(70,"input",24),a.Tb(),a.Tb(),a.Ub(71,"nz-form-item"),a.Ub(72,"nz-form-label",2),a.Hc(73,"City"),a.Tb(),a.Ub(74,"nz-form-control",3),a.Pb(75,"input",25),a.Tb(),a.Tb(),a.Ub(76,"nz-form-item"),a.Ub(77,"nz-form-label",2),a.Hc(78,"State"),a.Tb(),a.Ub(79,"nz-form-control",3),a.Pb(80,"input",26),a.Tb(),a.Tb(),a.Ub(81,"nz-form-item"),a.Ub(82,"nz-form-label",2),a.Hc(83,"ZIP"),a.Tb(),a.Ub(84,"nz-form-control",3),a.Pb(85,"input",27),a.Tb(),a.Tb(),a.Ub(86,"nz-form-item"),a.Ub(87,"nz-form-label",5),a.Hc(88,"Company"),a.Tb(),a.Ub(89,"nz-form-control",3),a.Pb(90,"input",28),a.Tb(),a.Tb(),a.Tb(),a.Pb(91,"nz-divider"),a.Ub(92,"nz-form-item",29),a.Ub(93,"nz-form-label",5),a.Hc(94,"Note"),a.Tb(),a.Ub(95,"nz-form-control",3),a.Pb(96,"textarea",30),a.Tb(),a.Tb(),a.Tb(),a.Tb(),a.Ub(97,"app-modal-footer",31),a.bc("saveEvent",function(e){return t.onSaveClick(e)})("closeEvent",function(){return t.closeModal()}),a.Tb(),a.Fc(98,E,2,2,"ng-template",null,32,a.Gc)),2&e){const e=a.uc(99);a.mc("formGroup",t.form),a.Ab(2),a.mc("appRolesAccess",a.oc(56,w)),a.Ab(2),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(1),a.mc("control",t.f.doctor)("url",t.doctorsUrl)("transformFunc",t.transformToDoctorClass)("disabled",!(null!=t.f.practice&&t.f.practice.valid))("loadOptions$",t.loadOptions$.asObservable())("canLoad",!1),a.Ab(2),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(1),a.mc("control",t.f.groups)("url",t.groupsUrl)("disabled",!(null!=t.f.practice&&t.f.practice.valid))("loadOptions$",t.loadOptions$.asObservable())("canLoad",!1),a.Ab(3),a.mc("nzSpan",5),a.Ab(4),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(2),a.mc("ngForOf",a.hc(33,53,t.sex,t.originalOrder)),a.Ab(3),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(1),a.mc("nzShowToday",!1),a.Ab(2),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(5),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(3),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(4),a.mc("nzSpan",5),a.Ab(2),a.mc("nzErrorTip",e),a.Ab(2),a.mc("processing",t.processing)("processingClose",t.processingClose)("isEditing",!(null==t.patient||!t.patient.id))("formValid",t.form.valid)}},directives:[h.t,h.o,z.b,h.i,v.a,g.c,z.c,g.a,z.d,z.a,T.a,y.a,U.b,h.d,h.n,h.g,C.d,_.n,A.b,h.j,O.a,C.a,_.o],pipes:[_.i],encapsulation:2}),e})();var I=n("pfyX"),F=n("4U9O"),M=n("1ReC"),N=n("Wfee"),j=n("rMZv"),L=n("OzZK"),H=n("C2AL"),$=n("FwiY"),R=n("pu9d");function K(e,t){1&e&&a.Pb(0,"nz-alert",6)}function V(e,t){if(1&e&&a.Pb(0,"nz-option",11),2&e){const e=t.$implicit;a.mc("nzValue",e.key)("nzLabel",e.value)}}function B(e,t){if(1&e){const e=a.Vb();a.Ub(0,"div"),a.Ub(1,"nz-form-item"),a.Ub(2,"nz-form-label",7),a.Hc(3,"Device type"),a.Tb(),a.Ub(4,"nz-form-control"),a.Ub(5,"nz-select",8),a.bc("ngModelChange",function(t){return a.vc(e),a.ec().onTypeChange(t)}),a.Fc(6,V,1,2,"nz-option",9),a.fc(7,"keyvalue"),a.Tb(),a.Tb(),a.Tb(),a.Ub(8,"nz-form-item"),a.Ub(9,"nz-form-label",7),a.Hc(10,"Device ID"),a.Tb(),a.Ub(11,"nz-form-control"),a.Ub(12,"app-select",10),a.bc("valueChangedEvt",function(t){a.vc(e);const n=a.ec();return n.onItemSelected(t,n.deviceControl,n.selectedDevices)}),a.Tb(),a.Tb(),a.Tb(),a.Tb()}if(2&e){const e=a.ec();a.Ab(2),a.mc("nzSpan",4),a.Ab(3),a.mc("formControl",e.deviceTypeControl)("nzDisabled",!e.patient.practice),a.Ab(1),a.mc("ngForOf",a.gc(7,12,e.deviceTypeOptions)),a.Ab(3),a.mc("nzSpan",4),a.Ab(3),a.mc("control",e.deviceControl)("url",e.devicesUrl)("transformFunc",e.transformToDeviceClass)("loadOptions$",e.loadOptions$.asObservable())("canLoad",!1)("disabledOptions",e.selectedDevices)("noDataText","No matching device found at "+(null==e.patient.practice?null:e.patient.practice.name))}}function G(e,t){if(1&e){const e=a.Vb();a.Ub(0,"tr"),a.Ub(1,"td"),a.Hc(2),a.Tb(),a.Ub(3,"td"),a.Hc(4),a.Tb(),a.Ub(5,"td"),a.Hc(6),a.fc(7,"deviceType"),a.Tb(),a.Ub(8,"td",12),a.Ub(9,"div"),a.Ub(10,"button",13),a.bc("click",function(){a.vc(e);const n=t.$implicit;return a.ec().onDeleteItemClick(n.id,"selectedDevices")}),a.Pb(11,"i",14),a.Tb(),a.Tb(),a.Tb(),a.Tb()}if(2&e){const e=t.$implicit;a.Ab(2),a.Ic(e.device_id),a.Ab(2),a.Ic(e.serial_number),a.Ab(2),a.Ic(a.gc(7,3,e.device_type))}}const q=function(){return{y:"123px"}},X=function(){return["auto","auto","auto","60px"]};let Y=(()=>{class e extends I.a{constructor(e,t){super(e),this.crudService=t,this.devicesUrl=s.f,this.deviceTypeControl=new h.e(null),this.deviceControl=new h.e(null),this.devices=new c.f("getDeviceOptions"),this.deviceTypeOptions=F.a,this.devicesDisplayColumns=[{name:"Device ID"},{name:"Serial number"},{name:"Device type"},{name:""}],this.selectedDevices=new Array,this.transformToDeviceClass=e=>Object.assign(new c.a,e)}onSaveClick(e){var t;const n=null===(t=this.patient)||void 0===t?void 0:t.id,r=this.crudService.addDevicesRequest(this.selectedDevices.map(e=>e.id),n);this.saveItem(e,r)}onTypeChange(e){this.patient.practice&&this.loadOptions$.next([{key:"device_type",value:e}])}ngOnInit(){this.selectedDevices.push(...this.patient.devices),this.patient.practice&&this.loadOptions$.next([{key:"practice",value:this.patient.practice.name},{key:"assigned_to_patient",value:!1}])}}return e.\u0275fac=function(t){return new(t||e)(a.Ob(u.c),a.Ob(b))},e.\u0275cmp=a.Ib({type:e,selectors:[["app-manage-devices-modal"]],features:[a.zb([b]),a.xb],decls:6,vars:14,consts:[["nzType","warning","nzMessage","To add a device, assign the patient to the hospital.","nzShowIcon","",4,"ngIf"],[4,"ngIf"],[1,"selected-items"],["nzSize","small",3,"nzTemplateMode","spinner","totalCount","nzScroll","nzWidthConfig","displayColumns"],[4,"ngFor","ngForOf"],[3,"processing","processingClose","isEditing","saveEvent","closeEvent"],["nzType","warning","nzMessage","To add a device, assign the patient to the hospital.","nzShowIcon",""],[3,"nzSpan"],["nzAllowClear","",3,"formControl","nzDisabled","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["labelKey","label","filterName","device_id","placeholder","Search and select device",3,"control","url","transformFunc","loadOptions$","canLoad","disabledOptions","noDataText","valueChangedEvt"],[3,"nzValue","nzLabel"],[1,"table-cell__actions"],["nz-button","","nzType","link","nzSize","small","nzDanger","",3,"click"],["nz-icon","","nzType","delete","nzTheme","outline"]],template:function(e,t){1&e&&(a.Fc(0,K,1,0,"nz-alert",0),a.Fc(1,B,13,14,"div",1),a.Ub(2,"div",2),a.Ub(3,"app-table-wrapper",3),a.Fc(4,G,12,5,"tr",4),a.Tb(),a.Tb(),a.Ub(5,"app-modal-footer",5),a.bc("saveEvent",function(e){return t.onSaveClick(e)})("closeEvent",function(){return t.closeModal()}),a.Tb()),2&e&&(a.mc("ngIf",!t.patient.practice),a.Ab(1),a.mc("ngIf",t.patient.practice),a.Ab(2),a.mc("nzTemplateMode",!0)("spinner",!1)("totalCount",t.selectedDevices.length)("nzScroll",a.oc(12,q))("nzWidthConfig",a.oc(13,X))("displayColumns",t.devicesDisplayColumns),a.Ab(1),a.mc("ngForOf",t.selectedDevices),a.Ab(1),a.mc("processing",t.processing)("processingClose",t.processingClose)("isEditing",!0))},directives:[_.o,M.a,_.n,O.a,N.a,g.c,z.c,g.a,z.d,z.a,C.d,h.n,h.f,T.a,C.a,j.i,j.b,L.a,H.a,$.a],pipes:[_.i,R.a],styles:[".selected-items[_ngcontent-%COMP%]{margin-bottom:16px}  .ant-table-expanded-row-fixed{width:455px!important}nz-alert[_ngcontent-%COMP%]{margin-bottom:24px}"],changeDetection:0}),e})();var J=n("o5fV"),W=n("CvgI"),Z=n("moCM"),Q=n("sWYD"),ee=n("C3di");const te={"font-size":"14px","font-family":"'Noto Sans', -apple-system, BlinkMacSystemFont, 'Open sans', 'Segoe UI', Roboto, 'Helvetica Neue',\n                  Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'"},ne={width:"100%","text-align":"left","border-radius":"2px 2px 0 0","border-collapse":"separate","border-spacing":0,border:"1px solid #f0f0f0","border-right":0,"border-bottom":0},re={color:"rgba(0, 0, 0, .85)","font-weight":500,background:"#fafafa","border-bottom":"1px solid #f0f0f0","border-right":"1px solid #f0f0f0",padding:"8px"},ie={"border-bottom":"1px solid #f0f0f0","border-right":"1px solid #f0f0f0",padding:"8px",color:"rgba(0, 0, 0, .65)"},ae={position:"relative",width:0,height:0,border:"8px solid",margin:0,color:"rgba(0, 0, 0, .65)","font-size":"12px","border-radius":"2px",padding:"0 7px"},oe={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#fff","-webkit-print-color-adjust":"exact"};class ce extends J.a{constructor(){super(),this.reportTitle="Measurements count report"}createDateRangeElem(e){const t=this.createElement("h3");return t.innerText=`From ${e.measurement_date_from} to ${e.measurement_date_until}`,t}createElement(e){return document.createElement(e)}createTableBody(e,t){const n=this.createElement("tbody");return e.forEach(e=>{const r=this.createElement("tr");t.forEach(t=>{var n;const i=this.createElement("td");let a;switch(!0){case!!t.subKeys:a=t.subKeys.map(n=>{const r=e[t.keys];return r?r[n]:"-"}).join(" ");break;case Array.isArray(t.keys):a=t.keys.map(t=>e[t]).join(" ");break;default:a=null!==(n=e[t.keys])&&void 0!==n?n:""}if("measurements_count"===t.keys){const e=this.createElement("div");Object.assign(e.style,ae),e.style.borderColor=Object(ee.a)(+a,this.numberOfDaysInRange);const t=this.createElement("span");Object.assign(t.style,oe),t.innerText=a,e.appendChild(t),i.appendChild(e)}else i.innerText=a;Object.assign(i.style,ie),r.appendChild(i)}),n.appendChild(r)}),n}createTable(e){const t=this.createElement("table");Object.assign(t.style,ne);const n=this.createElement("thead"),r=this.createElement("tr");return e.forEach(e=>{const t=this.createElement("th");t.innerText=e.displayName,Object.assign(t.style,re),r.appendChild(t)}),n.appendChild(r),t.appendChild(r),t}createHeader(){const e=this.createElement("div"),t=this.createElement("h1");return t.innerText=this.reportTitle,e.appendChild(t),e}createReport(e,t,n,r){const i=new Date(n.measurement_date_until),a=new Date(n.measurement_date_from);this.numberOfDaysInRange=(Math.floor(Object(Z.a)(i,a)/24)||0)+1;const o=this.createTable(t),c=this.createTableBody(e,t);o.appendChild(c);const s=window.open("","_blank","top=0, left=0, height=100%, width=auto").document,l=this.createElement("title");l.innerText=this.reportTitle,s.head.appendChild(l);const m=s.body;Object.assign(m.style,te);const b=this.createHeader();r&&b.appendChild(r),b.appendChild(this.createDateRangeElem(n)),m.appendChild(b),m.appendChild(o)}getPatientList(e){return this.getItems(e,s.y)}fetchMeasurementsCountReportData(e,t,n){const r={measurement_date_from:Object(Q.a)(e[0],"yyyy-MM-dd"),measurement_date_until:Object(Q.a)(e[1],"yyyy-MM-dd")},i=Object(W.a)(r);return this.http.get(s.A,{params:i}).pipe(Object(m.a)(e=>this.createReport(e.items,n,r,t)))}}class se extends ce{constructor(){super()}addPatient(){return this.openModal("Add new patient",void 0,x,!0,1e3)}editPatient(e){return this.openModal(`Edit patient ${e.first_name} ${e.last_name}`,{patient:e},x,!0,1e3)}manageDevices(e){return this.openModal(`Device management, patient ${e.first_name} ${e.last_name}`,{patient:e},Y)}deletePatient(e){return this.deleteItem(`Are you sure you want to delete patient ${e.first_name} ${e.last_name}?`,Object(s.B)(e.id))}}let le=(()=>{class e extends se{constructor(){super(),this.displayColumns=[{name:"Patient ID",filterKey:"patient_id",customFilter:"search",filter:!0,visible:!1},{name:"Name",filterKey:"name",customFilter:"search",filter:!0,visible:!1},{name:"BP measurements this month"},{name:"Last measurement date",filterKey:"last_measurement_date",customFilter:"date",sort:!0,filter:!0,visible:!1},{name:"Devices"},{name:"Practice",filterKey:"practice",customFilter:"search",filter:!0,visible:!1},{name:"Doctor",filterKey:"doctor_name",customFilter:"search",filter:!0,visible:!1},{name:"Group"},{name:""}],this.reportColumns=[{keys:"patient_id",displayName:"Patient ID"},{keys:["first_name","middle_name","last_name"],displayName:"Patient"},{keys:"practice",subKeys:["name"],displayName:"Practice"},{keys:"measurements_count",displayName:"BP measurements count"}]}addPatient(){return this.openModal("Add new patient",void 0,x,!0,1e3)}editPatient(e){return this.openModal(`Edit patient ${e.first_name} ${e.last_name}`,{patient:e},x,!0,1e3)}manageDevices(e){return this.openModal(`Device management, patient ${e.first_name} ${e.last_name}`,{patient:e},Y)}deletePatient(e){return this.deleteItem(`Are you sure you want to delete patient ${e.first_name} ${e.last_name}?`,Object(s.B)(e.id))}getMeasurementsCountReport(e){return this.fetchMeasurementsCountReportData(e,null,this.reportColumns)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=a.Kb({token:e,factory:e.\u0275fac,providedIn:o}),e})();var me=n("z6cu");let be=(()=>{class e extends ce{constructor(e){super(),this.currentUserService=e,this.displayColumns=[{name:"Patient ID",filterKey:"patient_id",customFilter:"search",filter:!0,visible:!1},{name:"Name",filterKey:"name",customFilter:"search",filter:!0,visible:!1},{name:"BP measurements this month"},{name:"Last measurement date",filterKey:"last_measurement_date",customFilter:"date",sort:!0,filter:!0,visible:!1},{name:"Devices"},{name:"Doctor",filterKey:"doctor_name",customFilter:"search",filter:!0,visible:!1},{name:"Group"},{name:""}],this.reportColumns=[{keys:"patient_id",displayName:"Patient ID"},{keys:["first_name","middle_name","last_name"],displayName:"Patient"},{keys:"measurements_count",displayName:"BP measurements count"}]}addPatient(){return Object(me.a)("No access for the role of doctor")}deletePatient(){return Object(me.a)("No access for the role of doctor")}editPatient(){return Object(me.a)("No access for the role of doctor")}manageDevices(){return Object(me.a)("No access for the role of doctor")}getMeasurementsCountReport(e){const t=this.createElement("div"),n=this.createElement("h2");n.innerText=this.currentUserService.currentUser.practice.name;const r=this.createElement("h2"),i=this.currentUserService.currentUser;return r.innerText=`${i.first_name} ${i.middle_name||""} ${i.last_name}`,t.appendChild(n),t.appendChild(r),this.fetchMeasurementsCountReportData(e,t,this.reportColumns)}}return e.\u0275fac=function(t){return new(t||e)(a.Yb(f.a))},e.\u0275prov=a.Kb({token:e,factory:e.\u0275fac,providedIn:o}),e})(),pe=(()=>{class e extends se{constructor(e){super(),this.currentUserService=e,this.displayColumns=[{name:"Patient ID",filterKey:"patient_id",customFilter:"search",filter:!0,visible:!1},{name:"Name",filterKey:"name",customFilter:"search",filter:!0,visible:!1},{name:"BP measurements this month"},{name:"Last measurement date",filterKey:"last_measurement_date",customFilter:"date",sort:!0,filter:!0,visible:!1},{name:"Devices"},{name:"Doctor",filterKey:"doctor_name",customFilter:"search",filter:!0,visible:!1},{name:"Group"},{name:""}],this.reportColumns=[{keys:"patient_id",displayName:"Patient ID"},{keys:["first_name","middle_name","last_name"],displayName:"Patient"},{keys:"measurements_count",displayName:"BP measurements count"}]}getMeasurementsCountReport(e){const t=this.createElement("h2");return t.innerText=this.currentUserService.currentUser.practice.name,this.fetchMeasurementsCountReportData(e,t,this.reportColumns)}}return e.\u0275fac=function(t){return new(t||e)(a.Yb(f.a))},e.\u0275prov=a.Kb({token:e,factory:e.\u0275fac,providedIn:o}),e})();const de=new a.q("PatientListService"),ue={provide:de,useFactory:e=>{switch(e.currentRole){case"admin":return new le;case"manager":return new pe(e);case"doctor":return new be(e)}},deps:[f.a,u.d]};var fe=n("Pj3g"),he=n("1G5W"),ze=n("eIep"),ve=n("nYR2"),ge=n("mCNh"),Te=n("gXqy"),ye=n("jPNr"),Ue=n("RwU8"),Ce=n("0wOC"),_e=n("Nqz0"),Ae=n("Q8cG");const Oe=function(){return["/import-data/patients"]};function Pe(e,t){1&e&&(a.Ub(0,"button",10),a.Hc(1,"Import patients"),a.Tb()),2&e&&a.mc("routerLink",a.oc(1,Oe))}function De(e,t){if(1&e){const e=a.Vb();a.Ub(0,"button",11),a.bc("click",function(){return a.vc(e),a.ec().onAddClick()}),a.Hc(1,"Add patient"),a.Tb()}}function ke(e,t){if(1&e&&(a.Ub(0,"div",17),a.Ub(1,"span"),a.Hc(2),a.fc(3,"deviceType"),a.Tb(),a.Tb()),2&e){const e=t.$implicit;a.Ab(2),a.Ic(a.gc(3,1,e.device_type))}}function Se(e,t){if(1&e&&(a.Ub(0,"td"),a.Hc(1),a.Tb()),2&e){const e=a.ec().$implicit;a.Ab(1),a.Ic(null==e.practice?null:e.practice.name)}}function Ee(e,t){if(1&e){const e=a.Vb();a.Ub(0,"span"),a.Pb(1,"nz-divider",18),a.Ub(2,"button",19),a.Pb(3,"i",20),a.Tb(),a.Ub(4,"nz-dropdown-menu",null,21),a.Ub(6,"ul",22),a.Ub(7,"button",23),a.bc("click",function(){a.vc(e);const t=a.ec().$implicit;return a.ec().onEditClick(t)}),a.Ub(8,"div",24),a.Pb(9,"i",25),a.Ub(10,"span"),a.Hc(11,"Edit"),a.Tb(),a.Tb(),a.Tb(),a.Ub(12,"button",23),a.bc("click",function(){a.vc(e);const t=a.ec().$implicit;return a.ec().onManageDevicesClick(t)}),a.Ub(13,"div",24),a.Pb(14,"i",26),a.Ub(15,"span"),a.Hc(16,"Manage devices"),a.Tb(),a.Tb(),a.Tb(),a.Ub(17,"button",23),a.bc("click",function(){a.vc(e);const t=a.ec().$implicit;return a.ec().onDeleteClick(t)}),a.Ub(18,"div",27),a.Pb(19,"i",28),a.Ub(20,"span"),a.Hc(21,"Delete"),a.Tb(),a.Tb(),a.Tb(),a.Tb(),a.Tb(),a.Tb()}if(2&e){const e=a.uc(5);a.Ab(2),a.mc("nzDropdownMenu",e)}}const we=function(e){return[e]},xe=function(){return["admin"]},Ie=function(e){return["/patient-details",e]},Fe=function(e){return{patient:e}},Me=function(){return["admin","manager"]};function Ne(e,t){if(1&e&&(a.Ub(0,"tr"),a.Ub(1,"td"),a.Hc(2),a.Tb(),a.Ub(3,"td"),a.Hc(4),a.Tb(),a.Ub(5,"td"),a.Ub(6,"app-tags",12),a.Hc(7),a.Tb(),a.Tb(),a.Ub(8,"td"),a.Hc(9),a.fc(10,"date"),a.Tb(),a.Ub(11,"td"),a.Fc(12,ke,4,3,"div",13),a.Tb(),a.Fc(13,Se,2,1,"td",14),a.Ub(14,"td"),a.Hc(15),a.Tb(),a.Ub(16,"td"),a.Hc(17),a.Tb(),a.Ub(18,"td",15),a.Ub(19,"a",16),a.Hc(20,"Details"),a.Tb(),a.Fc(21,Ee,22,1,"span",14),a.Tb(),a.Tb()),2&e){const e=t.$implicit;a.Ab(2),a.Ic(e.patient_id),a.Ab(2),a.Lc("",e.first_name," ",e.middle_name," ",e.last_name,""),a.Ab(2),a.mc("data",a.pc(19,we,e.month_measurements_count)),a.Ab(1),a.Jc(" ",e.month_measurements_count," "),a.Ab(2),a.Ic(a.hc(10,16,e.last_measurement_date,"short")),a.Ab(3),a.mc("ngForOf",e.devices),a.Ab(1),a.mc("appRolesAccess",a.oc(21,xe)),a.Ab(2),a.Lc("",null==e.doctor?null:e.doctor.first_name," ",null==e.doctor?null:e.doctor.last_name," - ",null==e.doctor?null:e.doctor.npi,""),a.Ab(2),a.Ic(null==e.groups[0]?null:e.groups[0].name),a.Ab(2),a.mc("routerLink",a.pc(22,Ie,e.id))("state",a.pc(24,Fe,e)),a.Ab(2),a.mc("appRolesAccess",a.oc(26,Me))}}const je=[{path:"",component:(()=>{class e extends fe.a{constructor(e){super(),this.patientListService=e,this.reportTimeControl=new h.e(null,[h.s.required]),this.displayColumns=this.patientListService.displayColumns}disabledDate(e){return Object(Te.a)(e,new Date)>0}getPatients(e=this.params){return this.getItems(this.patientListService.getPatientList(e)).pipe(Object(he.a)(this.destroyed))}get patientsPipe(){return Object(ge.a)(Object(ze.a)(()=>this.getPatients()))}onAddClick(){this.patientListService.addPatient().pipe(this.patientsPipe).subscribe()}onEditClick(e){this.patientListService.editPatient(e).pipe(this.patientsPipe).subscribe()}onManageDevicesClick(e){this.patientListService.manageDevices(e).pipe(this.patientsPipe).subscribe()}onDeleteClick(e){this.patientListService.deletePatient(e).pipe(Object(ze.a)(()=>1===this.items.length?this.goToPrevPage():this.getPatients())).subscribe()}onGenerateReportClick(){this.generatingReport=!0,this.patientListService.getMeasurementsCountReport(this.reportTimeControl.value).pipe(Object(he.a)(this.destroyed),Object(ve.a)(()=>this.generatingReport=!1)).subscribe()}onQueryParamsChange(e){this.params=e,this.getPatients().subscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.Ob(de))},e.\u0275cmp=a.Ib({type:e,selectors:[["ng-component"]],features:[a.zb([ue]),a.xb],decls:14,vars:13,consts:[[1,"panel"],["nzTitle","Patient list",1,"page-header"],[1,"report"],[1,"report__title"],[1,"report__datepicker",3,"formControl","nzDisabledDate"],["nz-button","","nzType","primary",3,"disabled","nzLoading","click"],["nz-button","","nzType","link",3,"routerLink",4,"appRolesAccess"],["nz-button","","nzType","primary",3,"click",4,"appRolesAccess"],[3,"data","displayColumns","totalCount","isLoading$","queryParamsChange"],[4,"ngFor","ngForOf"],["nz-button","","nzType","link",3,"routerLink"],["nz-button","","nzType","primary",3,"click"],["type","measurementsCount",3,"data"],["class","cell cell--devices",4,"ngFor","ngForOf"],[4,"appRolesAccess"],[1,"table-cell__actions"],["nz-button","","nzType","link","nzSize","small","skipLocationChange","",3,"routerLink","state"],[1,"cell","cell--devices"],["nzType","vertical"],["nz-button","","nzType","link","nzTrigger","click","nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","icon:more","nzTheme","outline"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",1,"btn--menu-item",3,"click"],[1,"ant-btn-sm","ant-btn-link","ant-btn"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-icon","","nzType","icon:device","nzTheme","outline"],[1,"ant-btn-sm","ant-btn-link","ant-btn","ant-btn-dangerous"],["nz-icon","","nzType","delete","nzTheme","outline"]],template:function(e,t){1&e&&(a.Ub(0,"div",0),a.Ub(1,"nz-page-header",1),a.Ub(2,"nz-page-header-extra"),a.Ub(3,"div",2),a.Ub(4,"p",3),a.Hc(5," Measurements count report "),a.Tb(),a.Pb(6,"nz-range-picker",4),a.Ub(7,"button",5),a.bc("click",function(){return t.onGenerateReportClick()}),a.Hc(8,"Generate report"),a.Tb(),a.Tb(),a.Ub(9,"div"),a.Fc(10,Pe,2,2,"button",6),a.Fc(11,De,2,0,"button",7),a.Tb(),a.Tb(),a.Tb(),a.Ub(12,"app-table-wrapper",8),a.bc("queryParamsChange",function(e){return t.onQueryParamsChange(e)}),a.Fc(13,Ne,22,27,"tr",9),a.Tb(),a.Tb()),2&e&&(a.Ab(6),a.mc("formControl",t.reportTimeControl)("nzDisabledDate",t.disabledDate),a.Ab(1),a.mc("disabled",t.generatingReport||!t.reportTimeControl.valid)("nzLoading",t.generatingReport),a.Ab(3),a.mc("appRolesAccess",a.oc(11,xe)),a.Ab(1),a.mc("appRolesAccess",a.oc(12,Me)),a.Ab(1),a.mc("data",t.items)("displayColumns",t.displayColumns)("totalCount",t.totalCount)("isLoading$",t.isLoading$.asObservable()),a.Ab(1),a.mc("ngForOf",t.items))},directives:[ye.a,ye.c,A.b,A.d,h.n,h.f,L.a,Ue.a,H.a,v.a,M.a,_.n,i.f,j.i,j.b,Ce.a,i.g,y.a,_e.d,_e.b,$.a,_e.e,Ae.c,Ae.d],pipes:[_.e,R.a],styles:["[_nghost-%COMP%]     .ant-page-header-heading-extra{display:flex;justify-content:space-between;align-items:flex-end}.cell--devices[_ngcontent-%COMP%], [_nghost-%COMP%]     .ant-page-header-heading{flex-direction:column}.cell--devices[_ngcontent-%COMP%]{display:flex}.report__title[_ngcontent-%COMP%]{font-size:1rem;font-weight:500}.report__datepicker[_ngcontent-%COMP%]{margin-right:1em}"]}),e})()}];let Le=(()=>{class e{}return e.\u0275mod=a.Mb({type:e}),e.\u0275inj=a.Lb({factory:function(t){return new(t||e)},imports:[[i.h.forChild(je)],i.h]}),e})();var He=n("S9na");let $e=(()=>{class e{}return e.\u0275mod=a.Mb({type:e}),e.\u0275inj=a.Lb({factory:function(t){return new(t||e)},imports:[[r.a,Le,o,He.a]]}),e})()}}]);