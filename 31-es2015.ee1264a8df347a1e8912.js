(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{MJku:function(e,r,t){"use strict";t.r(r),t.d(r,"ShipstationModule",function(){return I});var n=t("PCNd"),o=t("tyNb"),i=t("3Pt+"),s=t("oaey"),c=t("LRne"),a=t("EY2u"),b=t("vkgz"),d=t("5+tZ"),m=t("lJxs"),f=t("JIr8"),l=t("1G5W"),p=t("pLZG"),u=t("UXun"),h=t("fXoL"),z=t("LEIr"),v=t("ILvI");let T=(()=>{class e{}return e.\u0275mod=h.Mb({type:e}),e.\u0275inj=h.Lb({factory:function(r){return new(r||e)}}),e})();var O=t("tk/3");let g=(()=>{class e{constructor(e){this.http=e}editOrder(e,r){return this.http.put(Object(v.u)(e),Object.assign({},r))}createOrder(e){const r=(new Date).toISOString();return this.http.post(v.c,{device_order_id:e}).pipe(Object(m.a)(e=>Object.assign(Object.assign({},e),{ship_date:r})))}compareAddresses(e,r){const t=Object.keys(e),n=Object.keys(r);if(t.length!==n.length)return!1;for(const o of t)if(e[o]!==r[o])return!1;return!0}}return e.\u0275fac=function(r){return new(r||e)(h.Yb(O.c))},e.\u0275prov=h.Kb({token:e,factory:e.\u0275fac,providedIn:T}),e})();var S=t("lhsU"),U=t("5vDB"),C=t("ocnv"),y=t("B+r4"),w=t("PTRe"),A=t("ofXK");function P(e,r){1&e&&(h.Sb(0),h.Hc(1," This field is required "),h.Rb())}function j(e,r){if(1&e&&(h.Sb(0),h.Hc(1),h.Rb()),2&e){const e=h.ec().$implicit;h.Ab(1),h.Jc(" ",e.errors.validationError," ")}}function E(e,r){if(1&e&&(h.Fc(0,P,2,0,"ng-container",15),h.Fc(1,j,2,1,"ng-container",15)),2&e){const e=r.$implicit;h.mc("ngIf",e.hasError("required")),h.Ab(1),h.mc("ngIf",e.hasError("validationError"))}}const _=[{path:"",component:(()=>{class e extends s.a{constructor(e,r,t){super(),this.orderDetailsService=e,this.shipstationService=r,this.errorService=t,this.cartonDimensionsLables=["Length","Width","Height"],this.formAddress=new i.h({company:new i.e(""),name:new i.e("",[i.s.required]),phone:new i.e(""),country:new i.e("",[i.s.required]),city:new i.e("",[i.s.required]),state:new i.e("",[i.s.required]),postal_code:new i.e("",[i.s.required]),street1:new i.e("",[i.s.required]),street2:new i.e(""),street3:new i.e("")})}get f(){return this.formAddress.controls}saveOrderAddressChanges(){if(this.shipstationService.compareAddresses(this.formAddress.value,this.orderDetailsService.orderInfo.address))return Object(c.a)(!0);for(const e in this.f)Object.prototype.hasOwnProperty.call(this.f,e)&&this.f[e].markAsTouched();return this.errorService.flattenError=!0,this.errorService.form=this.formAddress,this.shipstationService.editOrder(this.orderDetailsService.orderInfo.id,{address:this.formAddress.value})}handleError(e){return e&&this.orderDetailsService.errors$.next("object"==typeof e?Object.values(e):e),this.orderDetailsService.onConfirmation$.next(!1),a.a}handleConfirmEvt(){this.orderDetailsService.confirmEvt.pipe(Object(b.a)(()=>{this.errorService.showNotif=!1,this.orderDetailsService.onConfirmation$.next(!0),this.orderDetailsService.errors$.next(null)}),Object(d.b)(()=>this.saveOrderAddressChanges().pipe(Object(m.a)(()=>this.orderDetailsService.orderInfo.address=this.formAddress.value),Object(f.a)(()=>this.handleError()))),Object(d.b)(()=>this.shipstationService.createOrder(this.orderDetailsService.orderInfo.id).pipe(Object(f.a)(e=>this.handleError(e.error.errors)))),Object(l.a)(this.destroyed)).subscribe(e=>{this.orderDetailsService.onConfirmation$.next(!1),this.errorService.showNotif=!0,e&&(this.orderDetailsService.orderInfo.ship_station_order_id=e.id,this.orderDetailsService.orderInfo.tracking_number=e.tracking_number,this.orderDetailsService.orderInfo.ship_date=e.ship_date,this.orderDetailsService.goToNextStep())})}ngOnInit(){this.handleConfirmEvt(),this.orderDetailsService.orderInfo$.pipe(Object(p.a)(e=>!!e),Object(l.a)(this.destroyed)).subscribe(e=>this.formAddress.patchValue(e.address)),this.formAddress.valueChanges.pipe(Object(l.a)(this.destroyed)).subscribe(()=>this.orderDetailsService.addressFormIsValid=this.formAddress.valid),this.onConfirmation$=this.orderDetailsService.onConfirmation$.pipe(Object(u.a)(1))}}return e.\u0275fac=function(r){return new(r||e)(h.Ob(z.a),h.Ob(g),h.Ob(S.a))},e.\u0275cmp=h.Ib({type:e,selectors:[["app-shipstation"]],features:[h.xb],decls:57,vars:11,consts:[["nzText","Edit postal information","nzOrientation","left",1,"large"],["nz-form","","nzLayout","vertical",1,"form",3,"formGroup"],["nzRequired",""],[3,"nzErrorTip"],["formControlName","name","nz-input",""],["formControlName","phone","nz-input",""],["formControlName","company","nz-input",""],["formControlName","country","nz-input",""],["formControlName","state","nz-input",""],["formControlName","city","nz-input",""],["formControlName","postal_code","nz-input",""],["formControlName","street1","nz-input",""],["formControlName","street2","nz-input",""],["formControlName","street3","nz-input",""],["errorTpl",""],[4,"ngIf"]],template:function(e,r){if(1&e&&(h.Pb(0,"nz-divider",0),h.Ub(1,"form",1),h.Ub(2,"section"),h.Ub(3,"nz-form-item"),h.Ub(4,"nz-form-label",2),h.Hc(5,"Name of receiver"),h.Tb(),h.Ub(6,"nz-form-control",3),h.Pb(7,"input",4),h.Tb(),h.Tb(),h.Ub(8,"nz-form-item"),h.Ub(9,"nz-form-label"),h.Hc(10,"Phone of receiver"),h.Tb(),h.Ub(11,"nz-form-control",3),h.Pb(12,"input",5),h.Tb(),h.Tb(),h.Ub(13,"nz-form-item"),h.Ub(14,"nz-form-label"),h.Hc(15,"Company"),h.Tb(),h.Ub(16,"nz-form-control",3),h.Pb(17,"input",6),h.Tb(),h.Tb(),h.Tb(),h.Ub(18,"section"),h.Ub(19,"nz-form-item"),h.Ub(20,"nz-form-label",2),h.Hc(21,"Country"),h.Tb(),h.Ub(22,"nz-form-control",3),h.Pb(23,"input",7),h.Tb(),h.Tb(),h.Ub(24,"nz-form-item"),h.Ub(25,"nz-form-label",2),h.Hc(26,"State"),h.Tb(),h.Ub(27,"nz-form-control",3),h.Pb(28,"input",8),h.Tb(),h.Tb(),h.Ub(29,"nz-form-item"),h.Ub(30,"nz-form-label",2),h.Hc(31,"City"),h.Tb(),h.Ub(32,"nz-form-control",3),h.Pb(33,"input",9),h.Tb(),h.Tb(),h.Ub(34,"nz-form-item"),h.Ub(35,"nz-form-label",2),h.Hc(36,"Postal code"),h.Tb(),h.Ub(37,"nz-form-control",3),h.Pb(38,"input",10),h.Tb(),h.Tb(),h.Tb(),h.Ub(39,"section"),h.Ub(40,"nz-form-item"),h.Ub(41,"nz-form-label",2),h.Hc(42,"Street 1"),h.Tb(),h.Ub(43,"nz-form-control",3),h.Pb(44,"input",11),h.Tb(),h.Tb(),h.Ub(45,"nz-form-item"),h.Ub(46,"nz-form-label"),h.Hc(47,"Street 2"),h.Tb(),h.Ub(48,"nz-form-control",3),h.Pb(49,"input",12),h.Tb(),h.Tb(),h.Ub(50,"nz-form-item"),h.Ub(51,"nz-form-label"),h.Hc(52,"Street 3"),h.Tb(),h.Ub(53,"nz-form-control",3),h.Pb(54,"input",13),h.Tb(),h.Tb(),h.Tb(),h.Tb(),h.Fc(55,E,2,2,"ng-template",null,14,h.Gc)),2&e){const e=h.uc(56);h.Ab(1),h.mc("formGroup",r.formAddress),h.Ab(5),h.mc("nzErrorTip",e),h.Ab(5),h.mc("nzErrorTip",e),h.Ab(5),h.mc("nzErrorTip",e),h.Ab(6),h.mc("nzErrorTip",e),h.Ab(5),h.mc("nzErrorTip",e),h.Ab(5),h.mc("nzErrorTip",e),h.Ab(5),h.mc("nzErrorTip",e),h.Ab(6),h.mc("nzErrorTip",e),h.Ab(5),h.mc("nzErrorTip",e),h.Ab(5),h.mc("nzErrorTip",e)}},directives:[U.a,i.t,i.o,C.b,i.i,y.c,C.c,y.a,C.d,C.a,i.d,w.b,i.n,i.g,A.o],styles:[".actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.form[_ngcontent-%COMP%]{max-width:900px}.form[_ngcontent-%COMP%] > section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:2em;align-items:center}.form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button, .form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.form[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]}),e})()}];let D=(()=>{class e{}return e.\u0275mod=h.Mb({type:e}),e.\u0275inj=h.Lb({factory:function(r){return new(r||e)},imports:[[o.h.forChild(_)],o.h]}),e})(),I=(()=>{class e{}return e.\u0275mod=h.Mb({type:e}),e.\u0275inj=h.Lb({factory:function(r){return new(r||e)},imports:[[n.a,D,T]]}),e})()}}]);