!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{TtQc:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return e.greenHighNormal="rgb(56, 142, 60)",e.greenNormal="rgb(67, 160, 71)",e.greenLowNormal="rgb(76, 175, 80)",e.greenLow="rgb(102, 187, 106)",e.redSevere="rgb(246, 71, 71)",e.redModerate="rgb(226, 106, 106)",e.redMild="rgb(224, 130, 131)",e.yellow="rgb(253, 191, 80)",e}({})},rXnx:function(t,n,a){"use strict";a.r(n),a.d(n,"PatientListModule",function(){return tt});var c,s=a("PCNd"),u=a("tyNb"),b=a("fXoL"),m=((c=function e(){l(this,e)}).\u0275mod=b.Mb({type:c}),c.\u0275inj=b.Lb({factory:function(e){return new(e||c)}}),c),p=a("TwVa"),d=a("ILvI"),f=a("vxZU"),v=a("lJxs"),h=function(e){i(n,e);var t=o(n);function n(){return l(this,n),t.call(this)}return r(n,[{key:"edit",value:function(e,t){return this.editItemRequest(e,"Patient updated successfully",Object(d.B)(t))}},{key:"create",value:function(e){return this.createItemRequest(e,"Patient created successfully",d.y)}},{key:"getDeviceOptions",value:function(e){var t=Object.assign(Object.assign({},e),{active:!0,assigned_to_patient:!1});return this.getOptions(t,d.f)}},{key:"getDoctorOptions",value:function(e){return this.getOptions(e,d.i)}},{key:"getGroupOptions",value:function(e){return this.getOptions(e,d.k)}},{key:"getPracticeOptions",value:function(e){return this.getOptions(e,d.C)}},{key:"addDevicesRequest",value:function(e,t){var n=this;return this.http.put(Object(d.B)(t),{devices:e}).pipe(Object(v.a)(function(e){return n.notifService.success("Devices added successfully",""),e}))}}]),n}(f.a),y=a("0x4I"),z=a("Yn1n"),g=a("dEAy"),T=a("+K6+"),U=a("3Pt+"),C=a("ocnv"),k=a("HZS1"),_=a("B+r4"),O=a("bb81"),A=a("5vDB"),P=a("PTRe"),S=a("zAKX"),D=a("ofXK"),w=a("0lU3"),E=a("VdD3");function j(e,t){if(1&e){var n=b.Vb();b.Ub(0,"nz-form-item"),b.Ub(1,"nz-form-label",2),b.Hc(2,"Practice"),b.Tb(),b.Ub(3,"nz-form-control",3),b.Ub(4,"app-select",33),b.bc("valueChangedEvt",function(e){return b.vc(n),b.ec().practiceValueChanged(e)}),b.Tb(),b.Tb(),b.Tb()}if(2&e){var r=b.ec(),i=b.uc(99);b.Ab(1),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",i),b.Ab(1),b.mc("control",r.f.practice)("url",r.practiceUrl)}}function x(e,t){if(1&e&&b.Pb(0,"nz-option",34),2&e){var n=t.$implicit;b.mc("nzValue",n.key)("nzLabel",n.value)}}function I(e,t){1&e&&(b.Sb(0),b.Hc(1," This field is required "),b.Rb())}function F(e,t){if(1&e&&(b.Sb(0),b.Hc(1),b.Rb()),2&e){var n=b.ec().$implicit;b.Ab(1),b.Jc(" ",n.errors.validationError," ")}}function M(e,t){if(1&e&&(b.Fc(0,I,2,0,"ng-container",35),b.Fc(1,F,2,1,"ng-container",35)),2&e){var n=t.$implicit;b.mc("ngIf",n.hasError("required")),b.Ab(1),b.mc("ngIf",n.hasError("validationError"))}}var N,L=function(){return["admin"]},R=((N=function(e){i(n,e);var t=o(n);function n(e,r,i){var a;return l(this,n),(a=t.call(this,e)).crudService=r,a.currentUserService=i,a.practiceUrl=d.C,a.groupsUrl=d.k,a.doctorsUrl=d.i,a.transformToDoctorClass=function(e){return Object.assign(new p.b,e)},a}return r(n,[{key:"onSaveClick",value:function(e){var t,n=null===(t=this.patient)||void 0===t?void 0:t.id,r=n?this.crudService.edit(this.formValue,n):this.crudService.create(this.formValue);this.saveItem(e,r)}},{key:"fillForm",value:function(e){var t;for(var n in e)if(e[n]&&Object.prototype.hasOwnProperty.call(this.f,n)){if("address"===n){this.f[n].patchValue(e[n]);continue}if("doctor"===n&&(e[n]=Object.assign(new p.b,e[n])),"groups"===n){e[n]=e[n].map(function(e){return Object.assign(new p.e,e)}),e[n].length&&this.f[n].patchValue(e[n][0].id,{emitEvent:!1});continue}if("birth_date"===n){this.f[n].patchValue(new Date(e[n]),{emitEvent:!1});continue}if("object"==typeof e[n]){this.f[n].patchValue(e[n].id,{emitEvent:!1});continue}this.f[n].patchValue(e[n],{emitEvent:!1})}this.patient.practice&&this.loadOptions$.next([{key:"practice",value:null===(t=this.patient.practice)||void 0===t?void 0:t.name}])}},{key:"ngOnInit",value:function(){var e=this.currentUserService.currentUser;e.role===z.a.manager&&(this.form.removeControl("practice"),this.loadOptions$.next([{key:"practice",value:e.practice.name}])),this.patient&&this.fillForm(this.patient)}}]),n}(y.a)).\u0275fac=function(e){return new(e||N)(b.Ob(g.c),b.Ob(h),b.Ob(T.a))},N.\u0275cmp=b.Ib({type:N,selectors:[["ng-component"]],features:[b.zb([h]),b.xb],decls:100,vars:57,consts:[["nz-form","",1,"form","form--large",3,"formGroup"],[4,"appRolesAccess"],["nzRequired","",3,"nzSpan"],[3,"nzErrorTip"],["labelKey","label","placeholder","Search and select doctor",3,"control","url","transformFunc","disabled","loadOptions$","canLoad"],[3,"nzSpan"],["placeholder","Search and select group",3,"control","url","disabled","loadOptions$","canLoad"],[1,"form__item","form__item--multiple-fields"],[1,"form__row"],[1,"form__column"],["nz-input","","formControlName","first_name","autocomplete","","placeholder","First name *"],["nzExtra","optional",3,"nzErrorTip"],["nz-input","","formControlName","middle_name","autocomplete","","placeholder","Middle name"],["nz-input","","formControlName","last_name","autocomplete","","placeholder","Last name *"],["nzFor","sex",3,"nzSpan"],["formControlName","sex"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["formControlName","birth_date","nzInputReadOnly","","nzFormat","MM/dd/yyyy",3,"nzShowToday"],["nz-input","","formControlName","patient_id","autocomplete",""],["nz-input","","formControlName","phone","autocomplete",""],["nz-input","","formControlName","email","autocomplete","","type","email"],["formGroupName","address"],["formControlName","street1","nz-input",""],["formControlName","street2","nz-input",""],["formControlName","street3","nz-input",""],["formControlName","city","nz-input",""],["formControlName","state","nz-input",""],["formControlName","postal_code","nz-input",""],["formControlName","company","nz-input",""],[1,"form__item","form__item--textarea"],["formControlName","notes","nz-input","","rows","3"],[3,"processing","processingClose","isEditing","formValid","saveEvent","closeEvent"],["errorTpl",""],["placeholder","Search and select practice",3,"control","url","valueChangedEvt"],[3,"nzValue","nzLabel"],[4,"ngIf"]],template:function(e,t){if(1&e&&(b.Ub(0,"form",0),b.Ub(1,"section"),b.Fc(2,j,5,4,"nz-form-item",1),b.Ub(3,"nz-form-item"),b.Ub(4,"nz-form-label",2),b.Hc(5,"Doctor"),b.Tb(),b.Ub(6,"nz-form-control",3),b.Pb(7,"app-select",4),b.Tb(),b.Tb(),b.Ub(8,"nz-form-item"),b.Ub(9,"nz-form-label",5),b.Hc(10,"Group"),b.Tb(),b.Ub(11,"nz-form-control",3),b.Pb(12,"app-select",6),b.Tb(),b.Tb(),b.Pb(13,"nz-divider"),b.Ub(14,"nz-form-item",7),b.Ub(15,"nz-form-label",2),b.Hc(16,"Name"),b.Tb(),b.Ub(17,"div",8),b.Ub(18,"nz-form-item",9),b.Ub(19,"nz-form-control",3),b.Pb(20,"input",10),b.Tb(),b.Tb(),b.Ub(21,"nz-form-item",9),b.Ub(22,"nz-form-control",11),b.Pb(23,"input",12),b.Tb(),b.Tb(),b.Ub(24,"nz-form-item",9),b.Ub(25,"nz-form-control",3),b.Pb(26,"input",13),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(27,"nz-form-item"),b.Ub(28,"nz-form-label",14),b.Hc(29,"Sex"),b.Tb(),b.Ub(30,"nz-form-control",3),b.Ub(31,"nz-select",15),b.Fc(32,x,1,2,"nz-option",16),b.fc(33,"keyvalue"),b.Tb(),b.Tb(),b.Tb(),b.Ub(34,"nz-form-item"),b.Ub(35,"nz-form-label",5),b.Hc(36,"Birthdate"),b.Tb(),b.Ub(37,"nz-form-control",3),b.Pb(38,"nz-date-picker",17),b.Tb(),b.Tb(),b.Ub(39,"nz-form-item"),b.Ub(40,"nz-form-label",2),b.Hc(41,"Patient ID"),b.Tb(),b.Ub(42,"nz-form-control",3),b.Pb(43,"input",18),b.Tb(),b.Tb(),b.Ub(44,"nz-form-item"),b.Ub(45,"nz-form-label",2),b.Hc(46,"Phone"),b.Tb(),b.Ub(47,"nz-form-control",3),b.Pb(48,"input",19),b.Tb(),b.Tb(),b.Ub(49,"nz-form-item"),b.Ub(50,"nz-form-label",5),b.Hc(51,"Email"),b.Tb(),b.Ub(52,"nz-form-control",3),b.Pb(53,"input",20),b.Tb(),b.Tb(),b.Tb(),b.Ub(54,"section"),b.Ub(55,"div",21),b.Ub(56,"nz-form-item"),b.Ub(57,"nz-form-label",2),b.Hc(58,"Street 1"),b.Tb(),b.Ub(59,"nz-form-control",3),b.Pb(60,"input",22),b.Tb(),b.Tb(),b.Ub(61,"nz-form-item"),b.Ub(62,"nz-form-label",5),b.Hc(63,"Street 2"),b.Tb(),b.Ub(64,"nz-form-control",3),b.Pb(65,"input",23),b.Tb(),b.Tb(),b.Ub(66,"nz-form-item"),b.Ub(67,"nz-form-label",5),b.Hc(68,"Street 3"),b.Tb(),b.Ub(69,"nz-form-control",3),b.Pb(70,"input",24),b.Tb(),b.Tb(),b.Ub(71,"nz-form-item"),b.Ub(72,"nz-form-label",2),b.Hc(73,"City"),b.Tb(),b.Ub(74,"nz-form-control",3),b.Pb(75,"input",25),b.Tb(),b.Tb(),b.Ub(76,"nz-form-item"),b.Ub(77,"nz-form-label",2),b.Hc(78,"State"),b.Tb(),b.Ub(79,"nz-form-control",3),b.Pb(80,"input",26),b.Tb(),b.Tb(),b.Ub(81,"nz-form-item"),b.Ub(82,"nz-form-label",2),b.Hc(83,"ZIP"),b.Tb(),b.Ub(84,"nz-form-control",3),b.Pb(85,"input",27),b.Tb(),b.Tb(),b.Ub(86,"nz-form-item"),b.Ub(87,"nz-form-label",5),b.Hc(88,"Company"),b.Tb(),b.Ub(89,"nz-form-control",3),b.Pb(90,"input",28),b.Tb(),b.Tb(),b.Tb(),b.Pb(91,"nz-divider"),b.Ub(92,"nz-form-item",29),b.Ub(93,"nz-form-label",5),b.Hc(94,"Note"),b.Tb(),b.Ub(95,"nz-form-control",3),b.Pb(96,"textarea",30),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(97,"app-modal-footer",31),b.bc("saveEvent",function(e){return t.onSaveClick(e)})("closeEvent",function(){return t.closeModal()}),b.Tb(),b.Fc(98,M,2,2,"ng-template",null,32,b.Gc)),2&e){var n=b.uc(99);b.mc("formGroup",t.form),b.Ab(2),b.mc("appRolesAccess",b.oc(56,L)),b.Ab(2),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(1),b.mc("control",t.f.doctor)("url",t.doctorsUrl)("transformFunc",t.transformToDoctorClass)("disabled",!(null!=t.f.practice&&t.f.practice.valid))("loadOptions$",t.loadOptions$.asObservable())("canLoad",!1),b.Ab(2),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(1),b.mc("control",t.f.groups)("url",t.groupsUrl)("disabled",!(null!=t.f.practice&&t.f.practice.valid))("loadOptions$",t.loadOptions$.asObservable())("canLoad",!1),b.Ab(3),b.mc("nzSpan",5),b.Ab(4),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(2),b.mc("ngForOf",b.hc(33,53,t.sex,t.originalOrder)),b.Ab(3),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(1),b.mc("nzShowToday",!1),b.Ab(2),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(5),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(3),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(4),b.mc("nzSpan",5),b.Ab(2),b.mc("nzErrorTip",n),b.Ab(2),b.mc("processing",t.processing)("processingClose",t.processingClose)("isEditing",!(null==t.patient||!t.patient.id))("formValid",t.form.valid)}},directives:[U.t,U.o,C.b,U.i,k.a,_.c,C.c,_.a,C.d,C.a,O.a,A.a,P.b,U.d,U.n,U.g,S.d,D.n,w.b,U.j,E.a,S.a,D.o],pipes:[D.i],encapsulation:2}),N),H=a("pfyX"),$=a("4U9O"),K=a("1ReC"),V=a("Wfee"),B=a("rMZv"),G=a("OzZK"),q=a("C2AL"),X=a("FwiY"),Y=a("pu9d");function J(e,t){1&e&&b.Pb(0,"nz-alert",6)}function W(e,t){if(1&e&&b.Pb(0,"nz-option",11),2&e){var n=t.$implicit;b.mc("nzValue",n.key)("nzLabel",n.value)}}function Z(e,t){if(1&e){var n=b.Vb();b.Ub(0,"div"),b.Ub(1,"nz-form-item"),b.Ub(2,"nz-form-label",7),b.Hc(3,"Device type"),b.Tb(),b.Ub(4,"nz-form-control"),b.Ub(5,"nz-select",8),b.bc("ngModelChange",function(e){return b.vc(n),b.ec().onTypeChange(e)}),b.Fc(6,W,1,2,"nz-option",9),b.fc(7,"keyvalue"),b.Tb(),b.Tb(),b.Tb(),b.Ub(8,"nz-form-item"),b.Ub(9,"nz-form-label",7),b.Hc(10,"Device ID"),b.Tb(),b.Ub(11,"nz-form-control"),b.Ub(12,"app-select",10),b.bc("valueChangedEvt",function(e){b.vc(n);var t=b.ec();return t.onItemSelected(e,t.deviceControl,t.selectedDevices)}),b.Tb(),b.Tb(),b.Tb(),b.Tb()}if(2&e){var r=b.ec();b.Ab(2),b.mc("nzSpan",4),b.Ab(3),b.mc("formControl",r.deviceTypeControl)("nzDisabled",!r.patient.practice),b.Ab(1),b.mc("ngForOf",b.gc(7,12,r.deviceTypeOptions)),b.Ab(3),b.mc("nzSpan",4),b.Ab(3),b.mc("control",r.deviceControl)("url",r.devicesUrl)("transformFunc",r.transformToDeviceClass)("loadOptions$",r.loadOptions$.asObservable())("canLoad",!1)("disabledOptions",r.selectedDevices)("noDataText","No matching device found at "+(null==r.patient.practice?null:r.patient.practice.name))}}function Q(e,t){if(1&e){var n=b.Vb();b.Ub(0,"tr"),b.Ub(1,"td"),b.Hc(2),b.Tb(),b.Ub(3,"td"),b.Hc(4),b.Tb(),b.Ub(5,"td"),b.Hc(6),b.fc(7,"deviceType"),b.Tb(),b.Ub(8,"td",12),b.Ub(9,"div"),b.Ub(10,"button",13),b.bc("click",function(){b.vc(n);var e=t.$implicit;return b.ec().onDeleteItemClick(e.id,"selectedDevices")}),b.Pb(11,"i",14),b.Tb(),b.Tb(),b.Tb(),b.Tb()}if(2&e){var r=t.$implicit;b.Ab(2),b.Ic(r.device_id),b.Ab(2),b.Ic(r.serial_number),b.Ab(2),b.Ic(b.gc(7,3,r.device_type))}}var ee,te,ne,re,ie=function(){return{y:"123px"}},ae=function(){return["auto","auto","auto","60px"]},oe=((ee=function(t){i(a,t);var n=o(a);function a(e,t){var r;return l(this,a),(r=n.call(this,e)).crudService=t,r.devicesUrl=d.f,r.deviceTypeControl=new U.e(null),r.deviceControl=new U.e(null),r.devices=new p.f("getDeviceOptions"),r.deviceTypeOptions=$.a,r.devicesDisplayColumns=[{name:"Device ID"},{name:"Serial number"},{name:"Device type"},{name:""}],r.selectedDevices=new Array,r.transformToDeviceClass=function(e){return Object.assign(new p.a,e)},r}return r(a,[{key:"onSaveClick",value:function(e){var t,n=null===(t=this.patient)||void 0===t?void 0:t.id,r=this.crudService.addDevicesRequest(this.selectedDevices.map(function(e){return e.id}),n);this.saveItem(e,r)}},{key:"onTypeChange",value:function(e){this.patient.practice&&this.loadOptions$.next([{key:"device_type",value:e}])}},{key:"ngOnInit",value:function(){var t;(t=this.selectedDevices).push.apply(t,e(this.patient.devices)),this.patient.practice&&this.loadOptions$.next([{key:"practice",value:this.patient.practice.name},{key:"assigned_to_patient",value:!1}])}}]),a}(H.a)).\u0275fac=function(e){return new(e||ee)(b.Ob(g.c),b.Ob(h))},ee.\u0275cmp=b.Ib({type:ee,selectors:[["app-manage-devices-modal"]],features:[b.zb([h]),b.xb],decls:6,vars:14,consts:[["nzType","warning","nzMessage","To add a device, assign the patient to the hospital.","nzShowIcon","",4,"ngIf"],[4,"ngIf"],[1,"selected-items"],["nzSize","small",3,"nzTemplateMode","spinner","totalCount","nzScroll","nzWidthConfig","displayColumns"],[4,"ngFor","ngForOf"],[3,"processing","processingClose","isEditing","saveEvent","closeEvent"],["nzType","warning","nzMessage","To add a device, assign the patient to the hospital.","nzShowIcon",""],[3,"nzSpan"],["nzAllowClear","",3,"formControl","nzDisabled","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["labelKey","label","filterName","device_id","placeholder","Search and select device",3,"control","url","transformFunc","loadOptions$","canLoad","disabledOptions","noDataText","valueChangedEvt"],[3,"nzValue","nzLabel"],[1,"table-cell__actions"],["nz-button","","nzType","link","nzSize","small","nzDanger","",3,"click"],["nz-icon","","nzType","delete","nzTheme","outline"]],template:function(e,t){1&e&&(b.Fc(0,J,1,0,"nz-alert",0),b.Fc(1,Z,13,14,"div",1),b.Ub(2,"div",2),b.Ub(3,"app-table-wrapper",3),b.Fc(4,Q,12,5,"tr",4),b.Tb(),b.Tb(),b.Ub(5,"app-modal-footer",5),b.bc("saveEvent",function(e){return t.onSaveClick(e)})("closeEvent",function(){return t.closeModal()}),b.Tb()),2&e&&(b.mc("ngIf",!t.patient.practice),b.Ab(1),b.mc("ngIf",t.patient.practice),b.Ab(2),b.mc("nzTemplateMode",!0)("spinner",!1)("totalCount",t.selectedDevices.length)("nzScroll",b.oc(12,ie))("nzWidthConfig",b.oc(13,ae))("displayColumns",t.devicesDisplayColumns),b.Ab(1),b.mc("ngForOf",t.selectedDevices),b.Ab(1),b.mc("processing",t.processing)("processingClose",t.processingClose)("isEditing",!0))},directives:[D.o,K.a,D.n,E.a,V.a,_.c,C.c,_.a,C.d,C.a,S.d,U.n,U.f,O.a,S.a,B.i,B.b,G.a,q.a,X.a],pipes:[D.i,Y.a],styles:[".selected-items[_ngcontent-%COMP%]{margin-bottom:16px}  .ant-table-expanded-row-fixed{width:455px!important}nz-alert[_ngcontent-%COMP%]{margin-bottom:24px}"],changeDetection:0}),ee),ce=a("o5fV"),se=a("CvgI"),le=a("moCM"),ue=a("sWYD"),be=a("C3di"),me={"font-size":"14px","font-family":"'Noto Sans', -apple-system, BlinkMacSystemFont, 'Open sans', 'Segoe UI', Roboto, 'Helvetica Neue',\n                  Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'"},pe={width:"100%","text-align":"left","border-radius":"2px 2px 0 0","border-collapse":"separate","border-spacing":0,border:"1px solid #f0f0f0","border-right":0,"border-bottom":0},de={color:"rgba(0, 0, 0, .85)","font-weight":500,background:"#fafafa","border-bottom":"1px solid #f0f0f0","border-right":"1px solid #f0f0f0",padding:"8px"},fe={"border-bottom":"1px solid #f0f0f0","border-right":"1px solid #f0f0f0",padding:"8px",color:"rgba(0, 0, 0, .65)"},ve={position:"relative",width:0,height:0,border:"8px solid",margin:0,color:"rgba(0, 0, 0, .65)","font-size":"12px","border-radius":"2px",padding:"0 7px"},he={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#fff","-webkit-print-color-adjust":"exact"},ye=function(e){i(n,e);var t=o(n);function n(){var e;return l(this,n),(e=t.call(this)).reportTitle="Measurements count report",e}return r(n,[{key:"createDateRangeElem",value:function(e){var t=this.createElement("h3");return t.innerText="From ".concat(e.measurement_date_from," to ").concat(e.measurement_date_until),t}},{key:"createElement",value:function(e){return document.createElement(e)}},{key:"createTableBody",value:function(e,t){var n=this,r=this.createElement("tbody");return e.forEach(function(e){var i=n.createElement("tr");t.forEach(function(t){var r,a,o=n.createElement("td");switch(!0){case!!t.subKeys:a=t.subKeys.map(function(n){var r=e[t.keys];return r?r[n]:"-"}).join(" ");break;case Array.isArray(t.keys):a=t.keys.map(function(t){return e[t]}).join(" ");break;default:a=null!==(r=e[t.keys])&&void 0!==r?r:""}if("measurements_count"===t.keys){var c=n.createElement("div");Object.assign(c.style,ve),c.style.borderColor=Object(be.a)(+a,n.numberOfDaysInRange);var s=n.createElement("span");Object.assign(s.style,he),s.innerText=a,c.appendChild(s),o.appendChild(c)}else o.innerText=a;Object.assign(o.style,fe),i.appendChild(o)}),r.appendChild(i)}),r}},{key:"createTable",value:function(e){var t=this,n=this.createElement("table");Object.assign(n.style,pe);var r=this.createElement("thead"),i=this.createElement("tr");return e.forEach(function(e){var n=t.createElement("th");n.innerText=e.displayName,Object.assign(n.style,de),i.appendChild(n)}),r.appendChild(i),n.appendChild(i),n}},{key:"createHeader",value:function(){var e=this.createElement("div"),t=this.createElement("h1");return t.innerText=this.reportTitle,e.appendChild(t),e}},{key:"createReport",value:function(e,t,n,r){var i=new Date(n.measurement_date_until),a=new Date(n.measurement_date_from);this.numberOfDaysInRange=(Math.floor(Object(le.a)(i,a)/24)||0)+1;var o=this.createTable(t),c=this.createTableBody(e,t);o.appendChild(c);var s=window.open("","_blank","top=0, left=0, height=100%, width=auto").document,l=this.createElement("title");l.innerText=this.reportTitle,s.head.appendChild(l);var u=s.body;Object.assign(u.style,me);var b=this.createHeader();r&&b.appendChild(r),b.appendChild(this.createDateRangeElem(n)),u.appendChild(b),u.appendChild(o)}},{key:"getPatientList",value:function(e){return this.getItems(e,d.y)}},{key:"fetchMeasurementsCountReportData",value:function(e,t,n){var r=this,i={measurement_date_from:Object(ue.a)(e[0],"yyyy-MM-dd"),measurement_date_until:Object(ue.a)(e[1],"yyyy-MM-dd")},a=Object(se.a)(i);return this.http.get(d.A,{params:a}).pipe(Object(v.a)(function(e){return r.createReport(e.items,n,i,t)}))}}]),n}(ce.a),ze=function(e){i(n,e);var t=o(n);function n(){return l(this,n),t.call(this)}return r(n,[{key:"addPatient",value:function(){return this.openModal("Add new patient",void 0,R,!0,1e3)}},{key:"editPatient",value:function(e){return this.openModal("Edit patient ".concat(e.first_name," ").concat(e.last_name),{patient:e},R,!0,1e3)}},{key:"manageDevices",value:function(e){return this.openModal("Device management, patient ".concat(e.first_name," ").concat(e.last_name),{patient:e},oe)}},{key:"deletePatient",value:function(e){return this.deleteItem("Are you sure you want to delete patient ".concat(e.first_name," ").concat(e.last_name,"?"),Object(d.B)(e.id))}}]),n}(ye),ge=((te=function(e){i(n,e);var t=o(n);function n(){var e;return l(this,n),(e=t.call(this)).displayColumns=[{name:"Patient ID",filterKey:"patient_id",customFilter:"search",filter:!0,visible:!1},{name:"Name",filterKey:"name",customFilter:"search",filter:!0,visible:!1},{name:"BP measurements this month"},{name:"Last measurement date",filterKey:"last_measurement_date",customFilter:"date",sort:!0,filter:!0,visible:!1},{name:"Devices"},{name:"Practice",filterKey:"practice",customFilter:"search",filter:!0,visible:!1},{name:"Doctor",filterKey:"doctor_name",customFilter:"search",filter:!0,visible:!1},{name:"Group"},{name:""}],e.reportColumns=[{keys:"patient_id",displayName:"Patient ID"},{keys:["first_name","middle_name","last_name"],displayName:"Patient"},{keys:"practice",subKeys:["name"],displayName:"Practice"},{keys:"measurements_count",displayName:"BP measurements count"}],e}return r(n,[{key:"addPatient",value:function(){return this.openModal("Add new patient",void 0,R,!0,1e3)}},{key:"editPatient",value:function(e){return this.openModal("Edit patient ".concat(e.first_name," ").concat(e.last_name),{patient:e},R,!0,1e3)}},{key:"manageDevices",value:function(e){return this.openModal("Device management, patient ".concat(e.first_name," ").concat(e.last_name),{patient:e},oe)}},{key:"deletePatient",value:function(e){return this.deleteItem("Are you sure you want to delete patient ".concat(e.first_name," ").concat(e.last_name,"?"),Object(d.B)(e.id))}},{key:"getMeasurementsCountReport",value:function(e){return this.fetchMeasurementsCountReportData(e,null,this.reportColumns)}}]),n}(ze)).\u0275fac=function(e){return new(e||te)},te.\u0275prov=b.Kb({token:te,factory:te.\u0275fac,providedIn:m}),te),Te=a("z6cu"),Ue=((re=function(e){i(n,e);var t=o(n);function n(e){var r;return l(this,n),(r=t.call(this)).currentUserService=e,r.displayColumns=[{name:"Patient ID",filterKey:"patient_id",customFilter:"search",filter:!0,visible:!1},{name:"Name",filterKey:"name",customFilter:"search",filter:!0,visible:!1},{name:"BP measurements this month"},{name:"Last measurement date",filterKey:"last_measurement_date",customFilter:"date",sort:!0,filter:!0,visible:!1},{name:"Devices"},{name:"Doctor",filterKey:"doctor_name",customFilter:"search",filter:!0,visible:!1},{name:"Group"},{name:""}],r.reportColumns=[{keys:"patient_id",displayName:"Patient ID"},{keys:["first_name","middle_name","last_name"],displayName:"Patient"},{keys:"measurements_count",displayName:"BP measurements count"}],r}return r(n,[{key:"addPatient",value:function(){return Object(Te.a)("No access for the role of doctor")}},{key:"deletePatient",value:function(){return Object(Te.a)("No access for the role of doctor")}},{key:"editPatient",value:function(){return Object(Te.a)("No access for the role of doctor")}},{key:"manageDevices",value:function(){return Object(Te.a)("No access for the role of doctor")}},{key:"getMeasurementsCountReport",value:function(e){var t=this.createElement("div"),n=this.createElement("h2");n.innerText=this.currentUserService.currentUser.practice.name;var r=this.createElement("h2"),i=this.currentUserService.currentUser;return r.innerText="".concat(i.first_name," ").concat(i.middle_name||""," ").concat(i.last_name),t.appendChild(n),t.appendChild(r),this.fetchMeasurementsCountReportData(e,t,this.reportColumns)}}]),n}(ye)).\u0275fac=function(e){return new(e||re)(b.Yb(T.a))},re.\u0275prov=b.Kb({token:re,factory:re.\u0275fac,providedIn:m}),re),Ce=((ne=function(e){i(n,e);var t=o(n);function n(e){var r;return l(this,n),(r=t.call(this)).currentUserService=e,r.displayColumns=[{name:"Patient ID",filterKey:"patient_id",customFilter:"search",filter:!0,visible:!1},{name:"Name",filterKey:"name",customFilter:"search",filter:!0,visible:!1},{name:"BP measurements this month"},{name:"Last measurement date",filterKey:"last_measurement_date",customFilter:"date",sort:!0,filter:!0,visible:!1},{name:"Devices"},{name:"Doctor",filterKey:"doctor_name",customFilter:"search",filter:!0,visible:!1},{name:"Group"},{name:""}],r.reportColumns=[{keys:"patient_id",displayName:"Patient ID"},{keys:["first_name","middle_name","last_name"],displayName:"Patient"},{keys:"measurements_count",displayName:"BP measurements count"}],r}return r(n,[{key:"getMeasurementsCountReport",value:function(e){var t=this.createElement("h2");return t.innerText=this.currentUserService.currentUser.practice.name,this.fetchMeasurementsCountReportData(e,t,this.reportColumns)}}]),n}(ze)).\u0275fac=function(e){return new(e||ne)(b.Yb(T.a))},ne.\u0275prov=b.Kb({token:ne,factory:ne.\u0275fac,providedIn:m}),ne),ke=new b.q("PatientListService"),_e={provide:ke,useFactory:function(e){switch(e.currentRole){case"admin":return new ge;case"manager":return new Ce(e);case"doctor":return new Ue(e)}},deps:[T.a,g.d]},Oe=a("Pj3g"),Ae=a("1G5W"),Pe=a("eIep"),Se=a("nYR2"),De=a("mCNh"),we=a("gXqy"),Ee=a("jPNr"),je=a("RwU8"),xe=a("0wOC"),Ie=a("Nqz0"),Fe=a("Q8cG"),Me=function(){return["/import-data/patients"]};function Ne(e,t){1&e&&(b.Ub(0,"button",10),b.Hc(1,"Import patients"),b.Tb()),2&e&&b.mc("routerLink",b.oc(1,Me))}function Le(e,t){if(1&e){var n=b.Vb();b.Ub(0,"button",11),b.bc("click",function(){return b.vc(n),b.ec().onAddClick()}),b.Hc(1,"Add patient"),b.Tb()}}function Re(e,t){if(1&e&&(b.Ub(0,"div",17),b.Ub(1,"span"),b.Hc(2),b.fc(3,"deviceType"),b.Tb(),b.Tb()),2&e){var n=t.$implicit;b.Ab(2),b.Ic(b.gc(3,1,n.device_type))}}function He(e,t){if(1&e&&(b.Ub(0,"td"),b.Hc(1),b.Tb()),2&e){var n=b.ec().$implicit;b.Ab(1),b.Ic(null==n.practice?null:n.practice.name)}}function $e(e,t){if(1&e){var n=b.Vb();b.Ub(0,"span"),b.Pb(1,"nz-divider",18),b.Ub(2,"button",19),b.Pb(3,"i",20),b.Tb(),b.Ub(4,"nz-dropdown-menu",null,21),b.Ub(6,"ul",22),b.Ub(7,"button",23),b.bc("click",function(){b.vc(n);var e=b.ec().$implicit;return b.ec().onEditClick(e)}),b.Ub(8,"div",24),b.Pb(9,"i",25),b.Ub(10,"span"),b.Hc(11,"Edit"),b.Tb(),b.Tb(),b.Tb(),b.Ub(12,"button",23),b.bc("click",function(){b.vc(n);var e=b.ec().$implicit;return b.ec().onManageDevicesClick(e)}),b.Ub(13,"div",24),b.Pb(14,"i",26),b.Ub(15,"span"),b.Hc(16,"Manage devices"),b.Tb(),b.Tb(),b.Tb(),b.Ub(17,"button",23),b.bc("click",function(){b.vc(n);var e=b.ec().$implicit;return b.ec().onDeleteClick(e)}),b.Ub(18,"div",27),b.Pb(19,"i",28),b.Ub(20,"span"),b.Hc(21,"Delete"),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb()}if(2&e){var r=b.uc(5);b.Ab(2),b.mc("nzDropdownMenu",r)}}var Ke=function(e){return[e]},Ve=function(){return["admin"]},Be=function(e){return["/patient-details",e]},Ge=function(e){return{patient:e}},qe=function(){return["admin","manager"]};function Xe(e,t){if(1&e&&(b.Ub(0,"tr"),b.Ub(1,"td"),b.Hc(2),b.Tb(),b.Ub(3,"td"),b.Hc(4),b.Tb(),b.Ub(5,"td"),b.Ub(6,"app-tags",12),b.Hc(7),b.Tb(),b.Tb(),b.Ub(8,"td"),b.Hc(9),b.fc(10,"date"),b.Tb(),b.Ub(11,"td"),b.Fc(12,Re,4,3,"div",13),b.Tb(),b.Fc(13,He,2,1,"td",14),b.Ub(14,"td"),b.Hc(15),b.Tb(),b.Ub(16,"td"),b.Hc(17),b.Tb(),b.Ub(18,"td",15),b.Ub(19,"a",16),b.Hc(20,"Details"),b.Tb(),b.Fc(21,$e,22,1,"span",14),b.Tb(),b.Tb()),2&e){var n=t.$implicit;b.Ab(2),b.Ic(n.patient_id),b.Ab(2),b.Lc("",n.first_name," ",n.middle_name," ",n.last_name,""),b.Ab(2),b.mc("data",b.pc(19,Ke,n.month_measurements_count)),b.Ab(1),b.Jc(" ",n.month_measurements_count," "),b.Ab(2),b.Ic(b.hc(10,16,n.last_measurement_date,"short")),b.Ab(3),b.mc("ngForOf",n.devices),b.Ab(1),b.mc("appRolesAccess",b.oc(21,Ve)),b.Ab(2),b.Lc("",null==n.doctor?null:n.doctor.first_name," ",null==n.doctor?null:n.doctor.last_name," - ",null==n.doctor?null:n.doctor.npi,""),b.Ab(2),b.Ic(null==n.groups[0]?null:n.groups[0].name),b.Ab(2),b.mc("routerLink",b.pc(22,Be,n.id))("state",b.pc(24,Ge,n)),b.Ab(2),b.mc("appRolesAccess",b.oc(26,qe))}}var Ye,Je,We,Ze=[{path:"",component:(Ye=function(e){i(n,e);var t=o(n);function n(e){var r;return l(this,n),(r=t.call(this)).patientListService=e,r.reportTimeControl=new U.e(null,[U.s.required]),r.displayColumns=r.patientListService.displayColumns,r}return r(n,[{key:"disabledDate",value:function(e){return Object(we.a)(e,new Date)>0}},{key:"getPatients",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.params;return this.getItems(this.patientListService.getPatientList(e)).pipe(Object(Ae.a)(this.destroyed))}},{key:"onAddClick",value:function(){this.patientListService.addPatient().pipe(this.patientsPipe).subscribe()}},{key:"onEditClick",value:function(e){this.patientListService.editPatient(e).pipe(this.patientsPipe).subscribe()}},{key:"onManageDevicesClick",value:function(e){this.patientListService.manageDevices(e).pipe(this.patientsPipe).subscribe()}},{key:"onDeleteClick",value:function(e){var t=this;this.patientListService.deletePatient(e).pipe(Object(Pe.a)(function(){return 1===t.items.length?t.goToPrevPage():t.getPatients()})).subscribe()}},{key:"onGenerateReportClick",value:function(){var e=this;this.generatingReport=!0,this.patientListService.getMeasurementsCountReport(this.reportTimeControl.value).pipe(Object(Ae.a)(this.destroyed),Object(Se.a)(function(){return e.generatingReport=!1})).subscribe()}},{key:"onQueryParamsChange",value:function(e){this.params=e,this.getPatients().subscribe()}},{key:"patientsPipe",get:function(){var e=this;return Object(De.a)(Object(Pe.a)(function(){return e.getPatients()}))}}]),n}(Oe.a),Ye.\u0275fac=function(e){return new(e||Ye)(b.Ob(ke))},Ye.\u0275cmp=b.Ib({type:Ye,selectors:[["ng-component"]],features:[b.zb([_e]),b.xb],decls:14,vars:13,consts:[[1,"panel"],["nzTitle","Patient list",1,"page-header"],[1,"report"],[1,"report__title"],[1,"report__datepicker",3,"formControl","nzDisabledDate"],["nz-button","","nzType","primary",3,"disabled","nzLoading","click"],["nz-button","","nzType","link",3,"routerLink",4,"appRolesAccess"],["nz-button","","nzType","primary",3,"click",4,"appRolesAccess"],[3,"data","displayColumns","totalCount","isLoading$","queryParamsChange"],[4,"ngFor","ngForOf"],["nz-button","","nzType","link",3,"routerLink"],["nz-button","","nzType","primary",3,"click"],["type","measurementsCount",3,"data"],["class","cell cell--devices",4,"ngFor","ngForOf"],[4,"appRolesAccess"],[1,"table-cell__actions"],["nz-button","","nzType","link","nzSize","small","skipLocationChange","",3,"routerLink","state"],[1,"cell","cell--devices"],["nzType","vertical"],["nz-button","","nzType","link","nzTrigger","click","nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","icon:more","nzTheme","outline"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",1,"btn--menu-item",3,"click"],[1,"ant-btn-sm","ant-btn-link","ant-btn"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-icon","","nzType","icon:device","nzTheme","outline"],[1,"ant-btn-sm","ant-btn-link","ant-btn","ant-btn-dangerous"],["nz-icon","","nzType","delete","nzTheme","outline"]],template:function(e,t){1&e&&(b.Ub(0,"div",0),b.Ub(1,"nz-page-header",1),b.Ub(2,"nz-page-header-extra"),b.Ub(3,"div",2),b.Ub(4,"p",3),b.Hc(5," Measurements count report "),b.Tb(),b.Pb(6,"nz-range-picker",4),b.Ub(7,"button",5),b.bc("click",function(){return t.onGenerateReportClick()}),b.Hc(8,"Generate report"),b.Tb(),b.Tb(),b.Ub(9,"div"),b.Fc(10,Ne,2,2,"button",6),b.Fc(11,Le,2,0,"button",7),b.Tb(),b.Tb(),b.Tb(),b.Ub(12,"app-table-wrapper",8),b.bc("queryParamsChange",function(e){return t.onQueryParamsChange(e)}),b.Fc(13,Xe,22,27,"tr",9),b.Tb(),b.Tb()),2&e&&(b.Ab(6),b.mc("formControl",t.reportTimeControl)("nzDisabledDate",t.disabledDate),b.Ab(1),b.mc("disabled",t.generatingReport||!t.reportTimeControl.valid)("nzLoading",t.generatingReport),b.Ab(3),b.mc("appRolesAccess",b.oc(11,Ve)),b.Ab(1),b.mc("appRolesAccess",b.oc(12,qe)),b.Ab(1),b.mc("data",t.items)("displayColumns",t.displayColumns)("totalCount",t.totalCount)("isLoading$",t.isLoading$.asObservable()),b.Ab(1),b.mc("ngForOf",t.items))},directives:[Ee.a,Ee.c,w.b,w.d,U.n,U.f,G.a,je.a,q.a,k.a,K.a,D.n,u.f,B.i,B.b,xe.a,u.g,A.a,Ie.d,Ie.b,X.a,Ie.e,Fe.c,Fe.d],pipes:[D.e,Y.a],styles:["[_nghost-%COMP%]     .ant-page-header-heading-extra{display:flex;justify-content:space-between;align-items:flex-end}.cell--devices[_ngcontent-%COMP%], [_nghost-%COMP%]     .ant-page-header-heading{flex-direction:column}.cell--devices[_ngcontent-%COMP%]{display:flex}.report__title[_ngcontent-%COMP%]{font-size:1rem;font-weight:500}.report__datepicker[_ngcontent-%COMP%]{margin-right:1em}"]}),Ye)}],Qe=((Je=function e(){l(this,e)}).\u0275mod=b.Mb({type:Je}),Je.\u0275inj=b.Lb({factory:function(e){return new(e||Je)},imports:[[u.h.forChild(Ze)],u.h]}),Je),et=a("S9na"),tt=((We=function e(){l(this,e)}).\u0275mod=b.Mb({type:We}),We.\u0275inj=b.Lb({factory:function(e){return new(e||We)},imports:[[s.a,Qe,m,et.a]]}),We)}}])}();